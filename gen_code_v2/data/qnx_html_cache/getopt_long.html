
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="getopt_long(), getopt_long_only()" /><meta name="abstract" content="Get long and short options from a command-line argument list" /><meta name="description" content="Get long and short options from a command-line argument list" /><meta name="indexterms" content="getopt_long(), getopt_long_only()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-g.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/g/getopt.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/g/getsubopt.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="getopt_long" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>getopt_long(), getopt_long_only()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="getopt_long">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-g.html" title="G">G</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-g.html" title="G"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">G</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">getopt_long()</span>, <span class="keyword apiname">getopt_long_only()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>


<div class="body refbody"><p class="shortdesc"><em class="ph i">Get long and short options from a command-line argument list</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;getopt.h&gt;

int getopt_long( int <var class="keyword varname">argc</var>,
                 char * const *<var class="keyword varname">argv</var>,
                 const char *<var class="keyword varname">optstring</var>,
                 const struct option *<var class="keyword varname">longopts</var>,
                 int *<var class="keyword varname">longindex</var>);

int getopt_long_only( int <var class="keyword varname">argc</var>,
                      char * const *<var class="keyword varname">argv</var>,
                      const char *<var class="keyword varname">optstring</var>,
                      const struct option *<var class="keyword varname">longopts</var>,
                      int *<var class="keyword varname">longindex</var>);

extern char *<var class="keyword varname">optarg</var>;
extern int <var class="keyword varname">optind</var>, <var class="keyword varname">opterr</var>, <var class="keyword varname">optopt</var>, <var class="keyword varname">optreset</var>;
</pre>

</div>


<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">argc</var></dt>

<dd class="dd">The number of entries in the argument array.</dd>




<dt class="dt dlterm"><var class="keyword varname">argv</var></dt>

<dd class="dd">The argument array that you want to parse.</dd>




<dt class="dt dlterm"><var class="keyword varname">optstring</var></dt>

<dd class="dd">A string of short options; see below.</dd>




<dt class="dt dlterm"><var class="keyword varname">longopts</var></dt>

<dd class="dd">An array of type <span class="keyword dtype">struct option</span> that describes the long options; see below.
  End the array by including an element with its <var class="keyword varname">name</var> field set to <span class="keyword const">NULL</span>.
</dd>




<dt class="dt dlterm"><var class="keyword varname">longindex</var></dt>

<dd class="dd"><span class="keyword const">NULL</span>, or a pointer to a location where the function can store the index of the
  long option in the <var class="keyword varname">longopts</var> array.
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>

<p class="p">Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">






The <span class="keyword apiname">getopt_long()</span> function is similar to
<a class="xref" href="getopt.html" title="Parse options from a command line"><span class="keyword apiname">getopt()</span></a>,
but it accepts short and long options.
Long options canâbut don't have toâcorrespond to short ones (e.g., to
serve as memory aids for new users).
</p>


<div class="note note"><span class="notetitle">Note:</span> 
The <span class="keyword apiname">getopt()</span> function is POSIX, and <span class="keyword apiname">getopt_long()</span> is NetBSD.
They handle the short options in slightly different ways:
with <span class="keyword apiname">getopt()</span>, <var class="keyword varname">optstring</var> supports neither the leading plus sign or hyphen,
nor the double colon for denoting optional arguments to options.
The <tt class="ph tt">W;</tt> notation is also unique to <span class="keyword apiname">getopt_long()</span>.
</div>


<p class="p">
The <var class="keyword varname">optstring</var> specifies the short options and consists of the following:
</p>


<ul class="ul">
<li class="li">A plus sign or a hyphen that affects the processing of
  arguments that aren't options:

  
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">

  <thead class="thead" align="left">
  <tr>
    <th class="entry" valign="top" id="d1895107e268">If you specify:</th>

    <th class="entry" valign="top" id="d1895107e271">Then <span class="keyword apiname">getopt_long()</span>:</th>

  </tr>

  </thead>


  <tbody class="tbody">
  <tr>
    <td class="entry" valign="top" headers="d1895107e268 d1895107e271 ">Neither</td>

    <td class="entry" valign="top" headers="d1895107e268 d1895107e271 ">Permutes the argument list so that non-options are eventually at the end</td>

  </tr>


  <tr>
    <td class="entry" valign="top" headers="d1895107e268 d1895107e271 ">A hyphen (<tt class="ph tt">-</tt>)</td>

    <td class="entry" valign="top" headers="d1895107e268 d1895107e271 ">Returns non-options as if they were associated with option character '\1'</td>

  </tr>


  <tr>
    <td class="entry" valign="top" headers="d1895107e268 d1895107e271 ">A plus sign (<tt class="ph tt">+</tt>)</td>

    <td class="entry" valign="top" headers="d1895107e268 d1895107e271 ">Stops processing options when it encounters the first non-option;
      this has the same effect as setting <span class="keyword envar">POSIXLY_CORRECT</span>
    </td>

  </tr>


  </tbody>

  </table>
</div>

</li>


<li class="li">An optional colon (<tt class="ph tt">:</tt>) that affects what <span class="keyword apiname">getopt_long()</span> does if
  it determines that the user didn't supply a required argument for an option:

  <ul class="ul">
  <li class="li">If you include a colon, <span class="keyword apiname">getopt_long()</span> returns a colon.</li>

  <li class="li">If you don't include a colon, <span class="keyword apiname">getopt_long()</span> returns a question mark
    and writes a diagnostic message to <var class="keyword varname">stderr</var>.
  </li>

  </ul>


  <p class="p">
  Setting <var class="keyword varname">opterr</var> to zero suppresses the diagnostic message without affecting
  which character <span class="keyword apiname">getopt_long()</span> returns.
  </p>

</li>


<li class="li">Zero or more short options, each of which is a single letter or digit:

  <ul class="ul">
  <li class="li">If a character is followed by a colon, the option requires an argument.</li>


  <li class="li">
  If a character is followed by two colons (<tt class="ph tt">::</tt>), the argument is optional.
  If the user puts a space between the option and its argument, <span class="keyword apiname">getopt_long()</span> doesn't
  associate the argument with the option.
  </li>


  <li class="li">These options can also include a <tt class="ph tt">W</tt> followed by a semicolon (<tt class="ph tt">W;</tt>).
    POSIX reserves the <span class="keyword option">-W</span> option for implementation extensions;
    <span class="keyword apiname">getopt_long()</span> interprets
    <span class="keyword option">-W</span> <var class="keyword varname">some_string</var>[=<var class="keyword varname">value</var>]
    as <span class="keyword option">--</span><var class="keyword varname">some_string</var>[=<var class="keyword varname">value</var>].
  </li>


  </ul>

</li>


</ul>


<p class="p">
Long options start with a double hyphen (<tt class="ph tt">--</tt>) and can be followed by an equals sign and an argument.
For example:
</p>


<pre class="pre codeblock">myprogram --myoption=somevalue</pre>


<p class="p">
The user can abbreviate long option names;
if <span class="keyword apiname">getopt_long()</span> can't determine the option, it returns a question mark.
</p>


<p class="p">

Use the <span class="keyword dtype">option</span> structure to define the long options:
</p>


<pre class="pre codeblock">
struct option {
    const char *name;
    int has_arg;
    int *flag;
    int val;
};
</pre>


<p class="p">
The members include:
</p>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">name</var></dt>

<dd class="dd">The option name without any leading hyphens.
</dd>




<dt class="dt dlterm"><var class="keyword varname">has_arg</var></dt>

<dd class="dd">Whether the option has an argument; one of:

  <ul class="ul">
  <li class="li"><span class="keyword const">no_argument</span> â no argument to the option is expected
    
  </li>


  <li class="li"><span class="keyword const">required_argument</span> â  an argument to the option is required,
    but the equals sign is optional.
    If the user doesn't specify the equals sign, <span class="keyword apiname">getopt_long</span> interprets the
    next array element as the argument.
    
  </li>


  <li class="li"><span class="keyword const">optional_argument</span> â  an argument to the option may be provided;
    <var class="keyword varname">optarg</var> is non-<span class="keyword const">NULL</span> if the user specified an argument.
    The user needs to specify the equals sign, or else <span class="keyword apiname">getopt_long</span> doesn't
    associate the argument with the option.
    
  </li>


  </ul>

</dd>




<dt class="dt dlterm"><var class="keyword varname">flag</var>, <var class="keyword varname">val</var></dt>

<dd class="dd">How to report or act on the long option:

  <ul class="ul">
  <li class="li">If <var class="keyword varname">flag</var> isn't <span class="keyword const">NULL</span>, then <span class="keyword apiname">getopt_long()</span> sets
    *<var class="keyword varname">flag</var> to the value in the <var class="keyword varname">val</var> field and then returns 0.
  </li>


  <li class="li">If <var class="keyword varname">flag</var> is <span class="keyword const">NULL</span>, then <span class="keyword apiname">getopt_long()</span> returns the
    value that you specified in <var class="keyword varname">val</var>.
    Setting <var class="keyword varname">flag</var> to <span class="keyword const">NULL</span> and setting <var class="keyword varname">val</var> to the
    corresponding short option makes this function act like <span class="keyword apiname">getopt()</span>.
  </li>


  </ul>

</dd>



</dl>


<p class="p">
If the <var class="keyword varname">longindex</var> argument isn't <span class="keyword const">NULL</span>, then <span class="keyword apiname">getopt_long()</span>
sets *<var class="keyword varname">longindex</var> to the index of the long option in the <var class="keyword varname">longopts</var> array.
</p>


<p class="p">
If you want to use <var class="keyword varname">getopt_long()</var> to evaluate multiple sets of arguments or to
evaluate a single set of arguments multiple times, set <var class="keyword varname">optreset</var> and <var class="keyword varname">optind</var>
to 1 before starting each additional set of calls to <var class="keyword varname">getopt_long()</var>.
</p>


<p class="p">
The <span class="keyword apiname">getopt_long_only()</span> function behaves identically to <span class="keyword apiname">getopt_long()</span>,
except that long options may start with a single or double hyphen (<tt class="ph tt">-</tt> or <tt class="ph tt">--</tt>).
If an option starting with a single hyphen doesn't match a long option but does
match a single-character option, the single-character option is returned.
If <span class="keyword apiname">getopt_long_only()</span> can't determine the option, it returns a question mark.
</p>


</div>


<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">
One of the following:
</p>


<ul class="ul">
<li class="li">the character corresponding to the next short option on the command line</li>


<li class="li">a value corresponding to the next long option on the command line:

  <ul class="ul">
  <li class="li">If the <var class="keyword varname">flag</var> field in <span class="keyword dtype">struct option</span> is <span class="keyword const">NULL</span>,
    <span class="keyword apiname">getopt_long()</span> and <span class="keyword apiname">getopt_long_only()</span> return the value specified in
    the <var class="keyword varname">val</var> field, which can be the corresponding short option.
  </li>


  <li class="li">If <var class="keyword varname">flag</var> isn't <span class="keyword const">NULL</span>, these functions return 0 and store <var class="keyword varname">val</var>
    in the location pointed to by <var class="keyword varname">flag</var>.
  </li>


  </ul>

</li>


<li class="li">a colon if the option is missing its argument and
  the first character (after the hyphen or plus sign, if present)  of <var class="keyword varname">optstring</var> is a colon.
</li>


<li class="li">a question mark if the user specified an unknown or ambiguous option, or
  there was a missing option argument and the first character (after the hyphen or plus sign, if present)
  of <var class="keyword varname">optstring</var> isn't a colon.
</li>


<li class="li">-1 when all command-line options have been parsed.</li>


</ul>


</div>


<div class="section"><h2 class="title sectiontitle">Environment variables:</h2>


<dl class="dl">

<dt class="dt dlterm"><span class="keyword const">POSIXLY_CORRECT</span></dt>

<dd class="dd">If set, option processing stops when the first non-option is found, and a leading <tt class="ph tt">-</tt> or <tt class="ph tt">+</tt> in
  <var class="keyword varname">optstring</var> is ignored.
</dd>



</dl>


</div>


<div class="section"><h2 class="title sectiontitle">Examples:</h2>


<pre class="pre codeblock">
#include &lt;getopt.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;fcntl.h&gt;

int decompress_it = 0;
int loop = 0;

void usage()
{
  printf ("Usage: my_program [-ab] [-f path] [-m [message]] [--buffered]\n");
  printf ("                  [--decompress] [--file path] [--loop [num_iterations]]\n");
}

int main (int argc, char **argv)
{
    int fd = -1;
    int longindex;
    int i, ch;
    int num_loops;

    static struct option longopts[] = {
        { "buffered", no_argument,  NULL, 'b' },
        { "file",   required_argument, NULL, 'f' },
        { "decompress",  no_argument,  &amp;decompress_it, 1 },
        { "loop",  optional_argument,  &amp;loop, 1 },
        { NULL, 0, NULL, 0 }
    };

    /* Uncomment this to suppress getopt_long()'s messages about missing arguments: */
    // opterr = 0;

    while ((ch = getopt_long(argc, argv, "abf:m::", longopts, &amp;longindex)) != -1) {
            
        switch (ch) {
        case '\1':
                /* Non-options are sent here if optstring starts with a hyphen. */
                printf ("  Option \\1: %s\n", optarg == NULL ? "NULL" : optarg);
                break;
        case 'a':
                printf ("   -a\n");
                break;
        case 'b':
                printf ("   -b or --buffered\n");
                break;
        case 'f':
	        printf ("   -f %s or --file=%s\n", optarg, optarg);
                if ((fd = open(optarg, O_RDONLY, 0)) == -1)
                   printf("      Unable to open the file '%s'\n", optarg);
                break;
        case 'm':
                if (optarg == NULL) {
                   printf ("   -m with no argument\n");
                } else {
                   printf ("   -m %s\n", optarg);
                }
                break;
        case 0:
                /* Process any long options that set a variable. */

                if (decompress_it) {
                    printf ("   --decompress.\n");
                }
                if (loop) {
                     if (optarg == NULL) {
                         printf ("   --loop with no argument; using the default of 10 loops.\n");
                         num_loops = 10;
                     } else {
                         num_loops = atoi (optarg);
                         printf ("   --loop=%d\n", num_loops);
                     }
                }
                break;
        case ':':
                /* An argument is missing and optstring starts with a colon;
                   handle this appropriately. */
                break;
        case '?':
                /* Ambiguous or unknown option, or an argument is missing and optstring
                   doesn't start with a colon; handle this appropriately. */
                break;
        default:
                usage();
                return EXIT_FAILURE;
        }
    }
    
    printf ("Done processing the options; argc = %d; optind=%d\n", argc, optind);

    for (i = optind; i &lt; argc; i++) {
       printf ("    %s\n", argv[i]);
    }

    return EXIT_SUCCESS;
}
</pre>

</div>


<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">NetBSD</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d1895107e750">Safety:</th>
<th class="entry" valign="top" id="d1895107e752">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d1895107e750 d1895107e752 ">Cancellation point</td>
<td class="entry" valign="top" headers="d1895107e750 d1895107e752 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d1895107e750 d1895107e752 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d1895107e750 d1895107e752 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1895107e750 d1895107e752 ">Signal handler</td>
<td class="entry" valign="top" headers="d1895107e750 d1895107e752 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1895107e750 d1895107e752 ">Thread</td>
<td class="entry" valign="top" headers="d1895107e750 d1895107e752 ">No</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>


<div class="related-links"><div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/g/getopt.html" title="Parse options from a command line">getopt()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/g/getsubopt.html" title="Parse suboptions from a string">getsubopt()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-g.html" title="G"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">G</span></a></span>  </div>
</body>
</html>