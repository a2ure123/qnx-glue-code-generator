
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="bt_get_backtrace()" /><meta name="abstract" content="Collect a backtrace" /><meta name="description" content="Collect a backtrace" /><meta name="indexterms" content="bt_get_backtrace()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-b.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.technotes/topic/backtrace.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.prog/topic/process_proc_filesystem.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_init_accessor.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_load_memmap.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_release_accessor.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_set_flags.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_sprn_memmap.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_sprnf_addrs.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_translate_addrs.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_unload_memmap.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.utilities/topic/p/pidin.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="bt_get_backtrace" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>bt_get_backtrace()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="bt_get_backtrace">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-b.html" title="B">B</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-b.html" title="B"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">B</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">bt_get_backtrace()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>



<div class="body refbody"><p class="shortdesc"><em class="ph i">Collect a backtrace</em></p>


<div class="section">
<div class="note note"><span class="notetitle">Note:</span> 


The backtrace library is an unsupported feature, due to its fragility.
For more information, see
<a class="xref" href="../../../com.qnx.doc.neutrino.technotes/topic/backtrace.html"><em class="ph i">Backtraces</em></a>
in the <span class="keyword">QNX Neutrino</span> technotes.
</div>

</div>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;backtrace.h&gt;

int bt_get_backtrace( bt_accessor_t *<var class="keyword varname">acc</var>,
                      bt_addr_t *<var class="keyword varname">addrs</var>,
                      int <var class="keyword varname">len</var> );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">acc</var></dt>

<dd class="dd">A pointer to a <span class="keyword dtype">bt_accessor_t</span> structure.
  This is an opaque structure that holds the identity of the thread to backtrace.
</dd>




<dt class="dt dlterm"><var class="keyword varname">addrs</var></dt>

<dd class="dd">An array of <span class="keyword dtype">bt_addr_t</span> members where the function
  can store the addresses; <samp class="ph codeph">addrs[0]</samp> is the top of stack.
</dd>




<dt class="dt dlterm"><var class="keyword varname">len</var></dt>

<dd class="dd">The maximum number of addresses to collect and store in <var class="keyword varname">addrs</var>.</dd>



</dl>


</div>


<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libbacktrace</span></p>

<p class="p">Use the <span class="keyword option">-l backtrace</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">
The <span class="keyword apiname">bt_get_backtrace()</span> function collects a backtrace up to <var class="keyword varname">len</var> deep.
The behavior depends on how you initialized the accessor when you called
<a class="xref" href="bt_init_accessor.html" title="Initialize a backtrace accessor"><span class="keyword apiname">bt_init_accessor()</span></a>:
</p>


<ul class="ul">
<li class="li">If <span class="keyword const">BT_SELF</span>, the library uses direct memory access to
  gather the information from the stack.
  
</li>


<li class="li">If <span class="keyword const">BT_THREAD</span>, or for <span class="keyword const">BT_PROCESS</span> where the
  process ID and thread ID are for the calling thread, the library uses direct
  memory access.
  
  
</li>


<li class="li">For <span class="keyword const">BT_THREAD</span> where the thread ID isn't for the calling
  thread, or for <span class="keyword const">BT_PROCESS</span> with the process ID of the
  calling process and the thread ID other than that of the calling thread,
  the library stops the thread, fetches the thread context and registers,
  uses direct memory access, and the restarts the thread.
</li>


<li class="li">For <span class="keyword const">BT_PROCESS</span> where the process ID isn't that of the
  calling process, the library stops the thread, fetches the thread
  context and registers, uses the process's entry in the
  <span class="ph filepath">/proc</span> filesystem to access memory,
  and then restarts the thread.
</li>


</ul>


<p class="p">
Note the following:
</p>


<ul class="ul">
<li class="li">When you're backtracing within the same process, if
  <span class="keyword apiname">bt_get_backtrace()</span> attempts to access a non-existent memory
  location, signals are masked, and <span class="keyword const">SIGSEGV</span> is trapped to
  avoid crashing the program.
</li>


<li class="li">QNX Neutrino 6.3.0 and earlier can't stop a single thread, so
  in this case stopping a thread really means stopping all threads in the
  process.
</li>


<li class="li">QNX Neutrino 6.3.2 and later can stop a single thread.</li>


<li class="li">If other applications and processes start and stop threads, it may
  interfere with <span class="keyword apiname">bt_get_backtrace()</span>.
</li>


</ul>

</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">
The number of addresses stored in <var class="keyword varname">addrs</var>.
</p>

</div>


<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">QNX Neutrino</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d1254062e255">Safety:</th>
<th class="entry" valign="top" id="d1254062e257">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d1254062e255 d1254062e257 ">Cancellation point</td>
<td class="entry" valign="top" headers="d1254062e255 d1254062e257 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1254062e255 d1254062e257 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d1254062e255 d1254062e257 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1254062e255 d1254062e257 ">Signal handler</td>
<td class="entry" valign="top" headers="d1254062e255 d1254062e257 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d1254062e255 d1254062e257 ">Thread</td>
<td class="entry" valign="top" headers="d1254062e255 d1254062e257 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>





<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.technotes/topic/backtrace.html" title="Backtraces (Technotes)">Backtraces (Technotes)</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.prog/topic/process_proc_filesystem.html" title="Controlling processes via the /proc filesystem (QNX Neutrino Programmer's Guide)">Controlling processes via the /proc filesystem (<span class="keyword">QNX Neutrino</span> Programmer's Guide)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_init_accessor.html" title="Initialize a backtrace accessor">bt_init_accessor()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_load_memmap.html" title="Load a memory map associated with a backtrace">bt_load_memmap()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_release_accessor.html" title="Release an accessor for a backtrace">bt_release_accessor()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_set_flags.html" title="Set or clear the flags for backtracing">bt_set_flags()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_sprn_memmap.html" title="Format the memory map information for a backtrace">bt_sprn_memmap()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_sprnf_addrs.html" title="Format the addresses from a backtrace">bt_sprnf_addrs()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_translate_addrs.html" title="Translate the addresses from a backtrace">bt_translate_addrs()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/b/bt_unload_memmap.html" title="Unload a memory map associated with a backtrace">bt_unload_memmap()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.utilities/topic/p/pidin.html" title="pidin backtrace (Utilities Reference)">pidin backtrace (Utilities Reference)</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-b.html" title="B"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">B</span></a></span>  </div>
</body>
</html>