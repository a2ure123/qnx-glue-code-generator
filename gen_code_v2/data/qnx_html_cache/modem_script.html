
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="modem_script()" /><meta name="abstract" content="Run a script on a device" /><meta name="description" content="Run a script on a device" /><meta name="indexterms" content="modem_script()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/modem_open.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/modem_read.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/modem_write.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="modem_script" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>modem_script()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="modem_script">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M">M</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">M</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">modem_script()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>


<div class="body refbody"><p class="shortdesc"><em class="ph i">Run a script on a device</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;sys/modem.h&gt;

int modem_script( int <var class="keyword varname">fd</var>,
                  struct modem_script* <var class="keyword varname">table</var>,
                  speed_t* <var class="keyword varname">baud</var>,
                  void (*<var class="keyword varname">io</var>)( 
                        char* <var class="keyword varname">progress</var>,
                        char* <var class="keyword varname">in</var>,
                        char* <var class="keyword varname">out</var> ),
                  int (*<var class="keyword varname">cancel</var>)(void) );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">fd</var></dt>

<dd class="dd">The file descriptor for the device that you want to read from; see
  <a class="xref" href="modem_open.html" title="Open a serial port"><span class="keyword apiname">modem_open()</span></a>.
</dd>




<dt class="dt dlterm"><var class="keyword varname">table</var></dt>

<dd class="dd">An array of <span class="keyword dtype">modem_script</span> structures that comprise a
  script of commands that you want to run on the device; see below.
</dd>




<dt class="dt dlterm"><var class="keyword varname">baud</var></dt>

<dd class="dd">A pointer to a <span class="keyword dtype">speed_t</span> where the function can store the
  baud rate (if your script says to do so).
</dd>




<dt class="dt dlterm"><var class="keyword varname">io</var></dt>

<dd class="dd">A function that's called to process each string that's emitted or received.</dd>




<dt class="dt dlterm"><var class="keyword varname">cancel</var></dt>

<dd class="dd"><span class="keyword const">NULL</span>, or a callback function that's called whenever
  the <var class="keyword varname">newquiet</var> time period (specified in the script) expires while
  waiting for input.
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>

<p class="p">Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.
</p>


</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">





The <span class="keyword apiname">modem_script()</span> function runs the script <var class="keyword varname">table</var>
on the device associated with the file descriptor <var class="keyword varname">fd</var>. The script
implements a simple state machine that emits strings and waits for responses.
</p>


<p class="p">
Each string that's emitted or received is passed to the function <span class="keyword apiname">io()</span> as follows:
</p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">

<thead class="thead" align="left">
<tr>
  <th class="entry" valign="top" id="d2211174e205">Call</th>

  <th class="entry" valign="top" id="d2211174e208">Description</th>

</tr>

</thead>


<tbody class="tbody">

<tr>
  <td class="entry" valign="top" headers="d2211174e205 d2211174e208 "><span class="keyword apiname">(*io)(str, 0, 0)</span></td>

  <td class="entry" valign="top" headers="d2211174e205 d2211174e208 ">Emitted <var class="keyword varname">progress</var> string</td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e205 d2211174e208 "><span class="keyword apiname">(*io)(0, str, 0)</span></td>

  <td class="entry" valign="top" headers="d2211174e205 d2211174e208 ">Received string</td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e205 d2211174e208 "><span class="keyword apiname">(*io)(0, 0, str)</span></td>

  <td class="entry" valign="top" headers="d2211174e205 d2211174e208 ">Emitted <var class="keyword varname">response</var> string</td>

</tr>


</tbody>

</table>
</div>


<p class="p">
This lets an application set up a callback that can display the
script's interaction in a status window.
</p>


<p class="p">
If you provide a <var class="keyword varname">cancel</var> function, it's called once each
<var class="keyword varname">newquiet</var> 1/10 of a second while waiting for input. If this function
returns a nonzero value, the read returns immediately with -1 and
<var class="keyword varname">errno</var> is set to <span class="keyword const">ETIMEDOUT</span>.
You can use the <var class="keyword varname">cancel</var> function 
as a callback in a graphical dialer that needs to support a cancel
button to stop a script.
</p>


<p class="p">
The <var class="keyword varname">table</var> is an array of <span class="keyword dtype">modem_script</span> structures that
contain the following members:

</p>


<dl class="dl">

<dt class="dt dlterm"><span class="keyword dtype">char</span> <var class="keyword varname">curstate</var></dt>

<dd class="dd">The current state. Execution always begins at 
  <a class="xref" href="#modem_script__state1">state 1</a>, which
  must be the first array element of <var class="keyword varname">table</var>.
  Multiple elements may have the same current state, in which case any
  received input is matched against each <var class="keyword varname">pattern</var> member for that state.
</dd>




<dt class="dt dlterm"><span class="keyword dtype">int</span> <var class="keyword varname">curflags</var></dt>

<dd class="dd">The flags to use on a pattern match of a response:
         
  <ul class="ul">
  <li class="li"><span class="keyword const">MODEM_NOECHO</span> â don't echo the response through
    the <span class="keyword apiname">io()</span> callback.
    
  </li>


  <li class="li"><span class="keyword const">MODEM_BAUD</span> â extract any number in the response
    and assign it to <var class="keyword varname">baud</var>.
    
  </li>


  </ul>
       
</dd>




<dt class="dt dlterm"><span class="keyword dtype">char</span> <var class="keyword varname">newstate</var></dt>

<dd class="dd">When a pattern match occurs with <var class="keyword varname">pattern</var>, this is the next state.
  A state transition causes <var class="keyword varname">response</var> to be output and <var class="keyword varname">newflags</var>,
  <var class="keyword varname">newtimeout</var>, and <var class="keyword varname">newquiet</var> to be saved 
  and associated with the new state.
  Changing to a new state of 0 causes <span class="keyword apiname">modem_script()</span>
  to return with the value in <var class="keyword varname">retvalue</var>.
</dd>




<dt class="dt dlterm"><span class="keyword dtype">int</span> <var class="keyword varname">newflags</var></dt>

<dd class="dd">Saved on a state transition and passed to <span class="keyword apiname">modem_read()</span>
  when waiting for a response in the new state.
  For information about these flags, see
  <a class="xref" href="modem_read.html" title="Read bytes from a file descriptor"><span class="keyword apiname">modem_read()</span></a>.
</dd>




<dt class="dt dlterm"><span class="keyword dtype">int</span> <var class="keyword varname">newtimeout</var></dt>

<dd class="dd">Saved on a state transition and passed to <span class="keyword apiname">modem_read()</span>
  when waiting for a response in the new state.
  This timeout is described in
  <a class="xref" href="modem_read.html" title="Read bytes from a file descriptor"><span class="keyword apiname">modem_read()</span></a>.
</dd>




<dt class="dt dlterm"><span class="keyword dtype">int</span> <var class="keyword varname">newquiet</var></dt>

<dd class="dd">Saved on a state transition and passed to <span class="keyword apiname">modem_read()</span>
  when waiting for a response in the new state.
  This quiet timeout is described in 
  <a class="xref" href="modem_read.html" title="Read bytes from a file descriptor"><span class="keyword apiname">modem_read()</span></a>.
</dd>




<dt class="dt dlterm"><span class="keyword dtype">short</span> <var class="keyword varname">retvalue</var></dt>

<dd class="dd">The return value when the script terminates with a pattern match, and the
  new state is 0.
</dd>




<dt class="dt dlterm"><span class="keyword dtype">char* </span><var class="keyword varname">pattern</var></dt>

<dd class="dd">A pattern to match against received characters. The pattern is matched using
  <a class="xref" href="../f/fnmatch.html" title="Check to see if a file or path name matches a pattern"><span class="keyword apiname">fnmatch()</span></a>.
  Only patterns in the current state or the wildcard state of 0 are matched.
  On a match, the current state changes to <var class="keyword varname">newstate</var>.
</dd>




<dt class="dt dlterm"><span class="keyword dtype">char* </span><var class="keyword varname">response</var></dt>

<dd class="dd">On a <var class="keyword varname">pattern</var> match, this response is output to the device.
  If the <var class="keyword varname">curflags</var> don't have <span class="keyword const">MODEM_NOECHO</span> set,
  the response is given to the callback function passed as the
  <var class="keyword varname">io</var> parameter.
  
</dd>




<dt class="dt dlterm"><span class="keyword dtype">char* </span><var class="keyword varname">progress</var></dt>

<dd class="dd">On a <var class="keyword varname">pattern</var> match, this progress string is passed to the
  callback function passed as the <var class="keyword varname">io</var> parameter.
</dd>



</dl>


<p class="p">
Here's an example that demonstrates the operation of the script:
</p>


<pre class="pre codeblock">
/*
 curstate curflags newstate newflags newtimeout newquiet retvalue pattern response
*/

struct modem_script table[] ={
  {1, 0,            1, 0,              2,  5, 0, NULL,              "ATZ\\r\\P0a"},
  {1, 0,            2, 0,              30, 5, 0, "*ok*",            "ATDT5910934"},
  {2, MODEM_BAUD,   3, MODEM_LASTLINE, 10, 5, 0, "*connect*",       NULL},
  {3, 0,            4, 0,              8,  5, 0, "*login:*",        "guest"},
  {4, MODEM_NOECHO, 5, 0,              15, 5, 0, "*password:*",     "xxxx"},
  {5, 0,            0, 0,              0,  0, 0, "*$ *",            NULL},
  {0, 0,            0, 0,              0,  0, 1, "*no carrier*",    NULL},
  {0, 0,            0, 0,              0,  0, 2, "*no answer*",     NULL},
  {0, 0,            0, 0,              0,  0, 3, "*no dialtone*",   NULL},
  {0, 0,            0, 0,              0,  0, 4, "*busy*",          NULL},
  { NULL }
};
</pre>


<p class="p">
When this script is passed to <span class="keyword apiname">modem_script()</span>, the current
state is set to 1, and the output is <samp class="ph codeph">ATZ</samp> (the <var class="keyword varname">response</var>
in the first array element).
</p>


<p class="p">
While in any state, <span class="keyword apiname">modem_script()</span> waits for input, matching
it against the current state or the wildcard state of 0.

</p>


<p class="p" id="modem_script__state1"><strong class="ph b">State 1</strong></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">

<thead class="thead" align="left">
<tr>
  <th class="entry" valign="top" id="d2211174e593">Input</th>

  <th class="entry" valign="top" id="d2211174e596">Action</th>

</tr>

</thead>


<tbody class="tbody">

<tr>
  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 "><samp class="ph codeph">*ok*</samp></td>

  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 ">Go to <a class="xref" href="#modem_script__state2">state 2</a> and emit <samp class="ph codeph">ATDT1-591-0934</samp>.
         The flags to be used in the new state are set to 0, the quiet time in
         the new state is set to 5/10 of a second, and the timeout time in the
         new state is set to 30 seconds.
  </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 "><samp class="ph codeph">*no carrier*</samp></td>

  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 ">Go to state 0 (the termination newstate), return
        with the contents of <var class="keyword varname">retvalue</var> (1).
  </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 "><samp class="ph codeph">*no answer*</samp></td>

  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 ">Go to state 0 (the termination newstate), return
        with the contents of <var class="keyword varname">retvalue</var> (2).
  </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 "><samp class="ph codeph">*no dialtone*</samp></td>

  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 ">Go to state 0 (the termination newstate), return
        with the contents of <var class="keyword varname">retvalue</var> (3).
  </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 "><samp class="ph codeph">*busy*</samp></td>

  <td class="entry" valign="top" headers="d2211174e593 d2211174e596 ">Go to state 0 (the termination newstate), return
        with the contents of <var class="keyword varname">retvalue</var> (4).
  </td>

</tr>


</tbody>

</table>
</div>


<p class="p" id="modem_script__state2"><strong class="ph b">State 2</strong></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">

<thead class="thead" align="left">
<tr>
  <th class="entry" valign="top" id="d2211174e687">Input</th>

  <th class="entry" valign="top" id="d2211174e690">Action</th>

</tr>

</thead>


<tbody class="tbody">

<tr>
  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 "><samp class="ph codeph">*connect*</samp></td>

  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 ">Go to <a class="xref" href="#modem_script__state3">state 3</a> and don't emit anything to the device.
        The flags to be used in the new state are set to
        <span class="keyword const">MODEM_LASTLINE</span>,
        the quiet time in
        the new state is set to 5/10 of a second, and the timeout time in the
        new state is set to 10 seconds. Since the current flags are
        <span class="keyword const">MODEM_BAUD</span>, the baud rate is extracted from the
        connect message.
  </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 "><samp class="ph codeph">*no carrier*</samp></td>

  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 ">Same as previous table</td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 "><samp class="ph codeph">*no answer*</samp></td>

  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 ">Same as previous table </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 "><samp class="ph codeph">*no dialtone*</samp></td>

  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 ">Same as previous table </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 "><samp class="ph codeph">*busy*</samp></td>

  <td class="entry" valign="top" headers="d2211174e687 d2211174e690 ">Same as previous table</td>

</tr>


</tbody>

</table>
</div>


<p class="p" id="modem_script__state3"><strong class="ph b">State 3</strong></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">

<thead class="thead" align="left">
<tr>
  <th class="entry" valign="top" id="d2211174e773">Input</th>

  <th class="entry" valign="top" id="d2211174e776">Action</th>

</tr>

</thead>


<tbody class="tbody">

<tr>
  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 "><samp class="ph codeph">*login*</samp></td>

  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 ">Go to <a class="xref" href="#modem_script__state4">state 4</a> and emit <samp class="ph codeph">guest</samp>.
        The flags to be used in the new state are set to 0,
        the quiet time in
        the new state is set to 5/10 of a second, and the timeout time in the
        new state is set to 8 seconds.
  </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 "><samp class="ph codeph">*no carrier*</samp></td>

  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 ">Same as previous table</td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 "><samp class="ph codeph">*no answer*</samp></td>

  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 ">Same as previous table </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 "><samp class="ph codeph">*no dialtone*</samp></td>

  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 ">Same as previous table </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 "><samp class="ph codeph">*busy*</samp></td>

  <td class="entry" valign="top" headers="d2211174e773 d2211174e776 ">Same as previous table</td>

</tr>


</tbody>

</table>
</div>


<p class="p" id="modem_script__state4"><strong class="ph b">State 4</strong></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">

<thead class="thead" align="left">
<tr>
  <th class="entry" valign="top" id="d2211174e855">Input</th>

  <th class="entry" valign="top" id="d2211174e858">Action</th>

</tr>

</thead>


<tbody class="tbody">

<tr>
  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 "><samp class="ph codeph">*password*</samp></td>

  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 ">Go to <a class="xref" href="#modem_script__state5">state 5</a> and emit <samp class="ph codeph">xxxx</samp>.
        The flags to be used in the new state are set to 0, the quiet time in
        the new state is set to 5/10 of a second, and the timeout time in the
        new state is set to 15 seconds. Since the current flags are
        <span class="keyword const">MODEM_NOECHO</span>, the password response <samp class="ph codeph">xxxx</samp>
        isn't sent to the <span class="keyword apiname">io()</span> callback.
  </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 "><samp class="ph codeph">*no carrier*</samp></td>

  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 ">Same as previous table</td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 "><samp class="ph codeph">*no answer*</samp></td>

  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 ">Same as previous table </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 "><samp class="ph codeph">*no dialtone*</samp></td>

  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 ">Same as previous table </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 "><samp class="ph codeph">*busy*</samp></td>

  <td class="entry" valign="top" headers="d2211174e855 d2211174e858 ">Same as previous table</td>

</tr>


</tbody>

</table>
</div>


<p class="p" id="modem_script__state5"><strong class="ph b">State 5</strong></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">

<thead class="thead" align="left">
<tr>
  <th class="entry" valign="top" id="d2211174e946">Input</th>

  <th class="entry" valign="top" id="d2211174e949">Action</th>

</tr>

</thead>


<tbody class="tbody">

<tr>
  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 "><samp class="ph codeph">*$ *</samp></td>

  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 ">Go to state 0 (the termination newstate), return
        with the contents of <var class="keyword varname">retvalue</var> (0).
  </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 "><samp class="ph codeph">*no carrier*</samp></td>

  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 ">Same as previous table</td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 "><samp class="ph codeph">*no answer*</samp></td>

  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 ">Same as previous table </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 "><samp class="ph codeph">*no dialtone*</samp></td>

  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 ">Same as previous table </td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 "><samp class="ph codeph">*busy*</samp></td>

  <td class="entry" valign="top" headers="d2211174e946 d2211174e949 ">Same as previous table</td>

</tr>


</tbody>

</table>
</div>


<p class="p">
If you set the flag <span class="keyword const">MODEM_BAUD</span> for a state, then any number
embedded in a matching response is extracted and assigned as a number
to the <var class="keyword varname">baud</var> parameter.

</p>


<p class="p">
If you don't set the flag <span class="keyword const">MODEM_NOECHO</span> for a state, then all emitted
strings are also given to the passed <var class="keyword varname">io</var> function as
<samp class="ph codeph">(*io)(0, 0, </samp><var class="keyword varname">response</var><samp class="ph codeph">)</samp>.

</p>

</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">
The <var class="keyword varname">retvalue</var> member of a script entry that terminates the script.
This will always be a positive number. If <var class="keyword varname">modem_script</var> fails,
it returns -1 and sets
<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a>.</p>

</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl" compact="compact">

<dt class="dt dlterm"><span class="keyword const">EAGAIN</span></dt>

<dd class="dd">The <span class="keyword const">O_NONBLOCK</span> flag is set for the file descriptor, and 
  the process would be delayed in the write operation.
</dd>




<dt class="dt dlterm"><span class="keyword const">EBADF</span></dt>

<dd class="dd">The file descriptor, <var class="keyword varname">filedes</var>, isn't a valid file descriptor open for writing.</dd>




<dt class="dt dlterm"><span class="keyword const">EINTR</span></dt>

<dd class="dd">The write operation was interrupted by a signal, and either no data
  was transferred, or the resource manager responsible for that file
  doesn't report partial transfers.
</dd>




<dt class="dt dlterm"><span class="keyword const">EIO</span></dt>

<dd class="dd">A physical I/O error occurred. The precise meaning depends on the device.</dd>




<dt class="dt dlterm"><span class="keyword const">EPIPE</span></dt>

<dd class="dd">An attempt was made to write to a pipe (or FIFO) that isn't open for
  reading by any process.
  A <span class="keyword const">SIGPIPE</span> signal is also sent to the process.
  
  
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">QNX Neutrino</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d2211174e1169">Safety:</th>
<th class="entry" valign="top" id="d2211174e1171">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d2211174e1169 d2211174e1171 ">Cancellation point</td>
<td class="entry" valign="top" headers="d2211174e1169 d2211174e1171 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d2211174e1169 d2211174e1171 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d2211174e1169 d2211174e1171 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2211174e1169 d2211174e1171 ">Signal handler</td>
<td class="entry" valign="top" headers="d2211174e1169 d2211174e1171 ">Read the <em class="ph i">Caveats</em></td>
</tr>

<tr><td class="entry" valign="top" headers="d2211174e1169 d2211174e1171 ">Thread</td>
<td class="entry" valign="top" headers="d2211174e1169 d2211174e1171 ">Read the <em class="ph i">Caveats</em></td>
</tr>

</tbody>

</table>
</div>

</div>



<div class="section"><h2 class="title sectiontitle">Caveats:</h2>


<p class="p">
Depending on what you do in your <var class="keyword varname">cancel</var> function, it might or
might not be safe to call <span class="keyword apiname">modem_script()</span> from a signal handler or
a multithreaded program.
</p>

</div>


</div>





<div class="related-links"><div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/modem_open.html" title="Open a serial port">modem_open()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/modem_read.html" title="Read bytes from a file descriptor">modem_read()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/modem_write.html" title="Write a string to a device">modem_write()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">M</span></a></span>  </div>
</body>
</html>