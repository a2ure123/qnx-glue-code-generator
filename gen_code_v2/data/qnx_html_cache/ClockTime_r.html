
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="ClockTime(), ClockTime_r()" /><meta name="abstract" content="Get or set a clock" /><meta name="description" content="Get or set a clock" /><meta name="indexterms" content="ClockTime(), ClockTime_r()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.getting_started/topic/s1_timer.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.prog/topic/timing_execution_times.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_getcpuclockid.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_gettime.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_settime.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clockadjust.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clockid.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clockperiod.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/procmgr_ability.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/syspage_entry.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/pthread_getcpuclockid.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="clocktime" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>ClockTime(), ClockTime_r()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="clocktime">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C">C</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">C</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">ClockTime()</span>, <span class="keyword apiname">ClockTime_r()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>


<div class="body refbody"><p class="shortdesc"><em class="ph i">Get or set a clock</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;sys/neutrino.h&gt;

int ClockTime( clockid_t <var class="keyword varname">id</var>,
               const uint64_t * <var class="keyword varname">new</var>,
               uint64_t * <var class="keyword varname">old</var> );

int ClockTime_r( clockid_t <var class="keyword varname">id</var>,
                 const uint64_t * <var class="keyword varname">new</var>,
                 uint64_t * <var class="keyword varname">old</var> );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">id</var></dt>

<dd class="dd">The clock ID; one of the following:

  <ul class="ul">
  <li class="li"><span class="keyword const">CLOCK_REALTIME</span> or <span class="keyword const">CLOCK_MONOTONIC</span>, 
    which are the IDs of the clocks that maintain the system time
    
    
  </li>


  <li class="li"><span class="keyword const">CLOCK_PROCESS_CPUTIME_ID</span>, <span class="keyword const">CLOCK_THREAD_CPUTIME_ID</span>,
    or a clock ID returned by
    <a class="xref" href="clock_getcpuclockid.html" title="Return the clock ID of the CPU-time clock from a specified process"><span class="keyword apiname">clock_getcpuclockid()</span></a>,
    <a class="xref" href="../p/pthread_getcpuclockid.html" title="Return the clock ID of the CPU-time clock from a specified thread"><span class="keyword apiname">pthread_getcpuclockid()</span></a>,
    or
    <a class="xref" href="clockid.html" title="Get the CPU-time clock ID for a given process and thread"><span class="keyword apiname">ClockId()</span></a>,
    representing the amount of time the process or thread has spent actually running.
    <span class="keyword const">CLOCK_PROCESS_CPUTIME_ID</span> and <span class="keyword const">CLOCK_THREAD_CPUTIME_ID</span> are
    special clock IDs that refer to the CPU time of the calling process and thread, respectively.
    See
    <span class="q">&#147;<a class="xref" href="../../../com.qnx.doc.neutrino.prog/topic/timing_execution_times.html">Monitoring execution times</a>&#148;</span>
    in the <span class="q">&#147;Understanding the Microkernel's Concept of Time&#148;</span> chapter of the
    <span class="keyword">QNX Neutrino</span> <cite class="cite">Programmer's Guide</cite>.
    
    
  </li>


  </ul>


  <p class="p">
  For more information about the different clocks, see 
  <span class="q">&#147;<a class="xref" href="../../../com.qnx.doc.neutrino.getting_started/topic/s1_timer_otherclock.html">Other clock sources</a>&#148;</span>
  in the Clocks, Timers, and Getting a Kick Every So Often of
  <cite class="cite">Getting Started with <span class="keyword">QNX Neutrino</span></cite>.
  </p>

</dd>




<dt class="dt dlterm"><var class="keyword varname">new</var></dt>

<dd class="dd"><span class="keyword const">NULL</span>, or a pointer to the absolute time, in nanoseconds, to set the clock to.
  This is used only if <var class="keyword varname">id</var> is <span class="keyword const">CLOCK_REALTIME</span>. 
</dd>




<dt class="dt dlterm"><var class="keyword varname">old</var></dt>

<dd class="dd"><span class="keyword const">NULL</span>, or a pointer to a location where the function can
  store the current time (before being changed by a non-<span class="keyword const">NULL</span> <var class="keyword varname">new</var>).
  <div class="note note"><span class="notetitle">Note:</span> The time value written by this function is not necessarily an integer multiple of the clock
      period reported by <a class="xref" href="clockperiod.html" title="Get or set a clock period"><span class="keyword apiname">ClockPeriod*()</span></a>.
  </div>

</dd>



</dl>

</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>


<p class="p">
Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">










You can use these kernel calls to:
</p>


<ul class="ul">
<li class="li">get or set the system clock if <var class="keyword varname">id</var> is
  <span class="keyword const">CLOCK_REALTIME</span>
</li>


<li class="li">get the system clock if <var class="keyword varname">id</var> is <span class="keyword const">CLOCK_MONOTONIC</span></li>


<li class="li">get the CPU-time clock for a process or a particular
  thread in a process, if the ID is one that you obtained by calling
  <a class="xref" href="clockid.html" title="Get the CPU-time clock ID for a given process and thread"><span class="keyword apiname">ClockId()</span></a>.
  On an SMP box, the time for a process may
  exceed the realtime number of nanoseconds that have elapsed because
  threads in the process can run on different CPUs at the same time.
</li>


</ul>


<p class="p">
The <span class="keyword apiname">ClockTime()</span> and <span class="keyword apiname">ClockTime_r()</span>
functions are identical except in the way they indicate errors.
See the <a class="xref" href="#clocktime__Returns">Returns</a> section for details.
</p>


<div class="note note"><span class="notetitle">Note:</span> 
Instead of using these kernel calls directly, consider calling
<a class="xref" href="clock_gettime.html" title="Get the current time of a clock"><span class="keyword apiname">clock_gettime()</span></a>
or
<a class="xref" href="clock_settime.html" title="Set a clock"><span class="keyword apiname">clock_settime()</span></a>.
</div>


<p class="p">
If <var class="keyword varname">new</var> isn't <span class="keyword const">NULL</span>, then it contains the absolute
time, in nanoseconds, to set the system clock to. 
This affects the software clock maintained by the system. 
It doesn't change any underlying hardware clock that maintains the time when
the system's power is turned off.
</p>


<div class="note note"><span class="notetitle">Note:</span> 
<ul class="ul">
<li class="li">
  In order to get the time for a CPU-time clock associated with another process,
  your process must have the <span class="keyword const">PROCMGR_AID_XPROCESS_QUERY</span> ability enabled.
</li>


<li class="li">You can set the time only when the <var class="keyword varname">id</var> is <span class="keyword const">CLOCK_REALTIME</span>.
In order to set the clock, your process must have the
<span class="keyword const">PROCMGR_AID_CLOCKSET</span> ability enabled.

</li>


</ul>


<p class="p">
For more information, see
<a class="xref" href="../p/procmgr_ability.html" title="Control a process's ability to perform certain operations"><span class="keyword apiname">procmgr_ability()</span></a>.
</p>

</div>


<p class="p">
If you call <span class="keyword apiname">ClockTime()</span> to set the time of day, the kernel
checks to see if the <samp class="ph codeph">SYSPAGE_ENTRY(qtime)-&gt;boot_time</samp> field is zero.
If it is, the kernel sets it to the appropriate value.
There's a <span class="keyword option">-T</span> option for all startup programs that
prevents the setting of this field, so that the kernel will set it the
first time you call <span class="keyword apiname">ClockTime()</span> to change the time of day.
This is useful if the RTC hardware isn't in UTC.
</p>


<p class="p">
Once set, the system time increments by some number of nanoseconds, based on
the resolution of the system clock. 
You can query or change this resolution by using the
<a class="xref" href="clockperiod.html" title="Get or set a clock period"><span class="keyword apiname">ClockPeriod()</span></a>
kernel call.
</p>


<p class="p">
If you change the time for <span class="keyword const">CLOCK_REALTIME</span>,
the change occurs immediately, and the expiry time for some timers might end up in the past.
In this case, the timers will expire on the next clock tick.
If you need the affected timers to expire before the next clock tick,
then before changing the time, set a high-resolution timer to expire just after the new time;
after you change the time, the high-resolution timer will expire and so will all the affected timers.
</p>


<p class="p"><strong class="ph b">Blocking states</strong></p>




<p class="p">
These calls don't block.
</p>

</div>



<div class="section" id="clocktime__Returns"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">
The only difference between these functions is the way they indicate errors:
</p>


<dl class="dl" compact="compact">

<dt class="dt dlterm"><span class="keyword apiname">ClockTime()</span></dt>

<dd class="dd">If an error occurs, the function returns -1 and sets
  <a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a>. 
  Any other value returned indicates success.
</dd>




<dt class="dt dlterm"><span class="keyword apiname">ClockTime_r()</span></dt>

<dd class="dd"><span class="keyword const">EOK</span> is returned on success. This function does <strong class="ph b">NOT</strong> set <var class="keyword varname">errno</var>.
  If an error occurs, the function returns a value in the Errors section.
 </dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl" compact="compact">

<dt class="dt dlterm"><span class="keyword const">EFAULT</span></dt>

<dd class="dd">A fault occurred when the kernel tried to access the buffers provided.</dd>




<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">The clock ID isn't valid, or you tried to set the time for an ID other than <span class="keyword const">CLOCK_REALTIME</span>.</dd>




<dt class="dt dlterm"><span class="keyword const">EPERM</span></dt>

<dd class="dd">One of the following occurred:

  <ul class="ul">
  <li class="li">The calling process doesn't have the required permission; see
    <a class="xref" href="../p/procmgr_ability.html" title="Control a process's ability to perform certain operations"><span class="keyword apiname">procmgr_ability()</span></a>.
  </li>


  <li class="li">You tried to set the time for a process or thread CPU-time clock.</li>


  </ul>

</dd>




<dt class="dt dlterm"><span class="keyword const">ESRCH</span></dt>

<dd class="dd">The process associated with this request doesn't exist.</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">QNX Neutrino</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d1301985e602">Safety:</th>
<th class="entry" valign="top" id="d1301985e604">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d1301985e602 d1301985e604 ">Cancellation point</td>
<td class="entry" valign="top" headers="d1301985e602 d1301985e604 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1301985e602 d1301985e604 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d1301985e602 d1301985e604 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1301985e602 d1301985e604 ">Signal handler</td>
<td class="entry" valign="top" headers="d1301985e602 d1301985e604 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d1301985e602 d1301985e604 ">Thread</td>
<td class="entry" valign="top" headers="d1301985e602 d1301985e604 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>


<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.getting_started/topic/s1_timer.html" title="Clocks, Timers, and Getting a Kick Every So Often (Getting Started with QNX Neutrino)">Clocks, Timers, and Getting a Kick Every So Often (Getting Started with <span class="keyword">QNX Neutrino</span>)</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.prog/topic/timing_execution_times.html" title="Monitoring execution times (Getting Started with QNX Neutrino)">Monitoring execution times (Getting Started with <span class="keyword">QNX Neutrino</span>)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_getcpuclockid.html" title="Return the clock ID of the CPU-time clock from a specified process">clock_getcpuclockid()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_gettime.html" title="Get the current time of a clock">clock_gettime()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_settime.html" title="Set a clock">clock_settime()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clockadjust.html" title="Adjust the time of a clock">ClockAdjust(), ClockAdjust_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clockid.html" title="Get the CPU-time clock ID for a given process and thread">ClockId(), ClockId_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clockperiod.html" title="Get or set a clock period">ClockPeriod(), ClockPeriod_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/procmgr_ability.html" title="Control a process's ability to perform certain operations">procmgr_ability()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/syspage_entry.html" title="Return an entry from the system page">SYSPAGE_ENTRY()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/pthread_getcpuclockid.html" title="Return the clock ID of the CPU-time clock from a specified thread">pthread_getcpuclockid()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">C</span></a></span>  </div>
</body>
</html>