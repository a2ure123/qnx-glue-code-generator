
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="mq_notify()" /><meta name="abstract" content="Ask to be notified when there's a message in the queue" /><meta name="description" content="Ask to be notified when there's a message in the queue" /><meta name="indexterms" content="mq_notify()" /><meta name="DC.subject" content=", mq_notify(), ,, MsgRegisterEvent(), MsgRegisterEvent_r()" /><meta name="keywords" content=", mq_notify(), ,, MsgRegisterEvent(), MsgRegisterEvent_r()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.sys_arch/topic/ipc_Message_queues.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.technotes/topic/managing_mq_mqueue.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/i/ionotify.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/mq_open.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/mq_receive.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/mq_send.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgregisterevent.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sigevent.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.utilities/topic/m/mq.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.utilities/topic/m/mqueue.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="mq_notify" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>mq_notify()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="mq_notify">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M">M</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">M</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">mq_notify()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>




<div class="body refbody"><p class="shortdesc"><em class="ph i">Ask to be notified when there's a message in the queue</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;mqueue.h&gt;

int mq_notify(
       mqd_t <var class="keyword varname">mqdes</var>, 
       const struct sigevent* <var class="keyword varname">notification</var> );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">mqdes</var></dt>

<dd class="dd">The message-queue descriptor, returned by
  <a class="xref" href="mq_open.html" title="Open a message queue"><span class="keyword apiname">mq_open()</span></a>,
  of the message queue that you want to get notification for.
</dd>




<dt class="dt dlterm"><var class="keyword varname">notification</var></dt>

<dd class="dd"><span class="keyword const">NULL</span>, or a pointer to a 
  <a class="xref" href="../s/sigevent.html" title="Structure that describes an event"><span class="keyword dtype">sigevent</span></a>
  structure that describes how you want to be notified. The event doesn't need to be registered.
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<ul class="ul">
<li class="li">For the traditional implementation, <span class="ph filepath">libc</span>:

  <p class="p">
  Use the <span class="keyword option">-l c</span> option to
  <a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
  to link against this library.
  This library is usually included automatically.
  </p>

</li>


<li class="li">For the alternate implementation that uses the <a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/m/mq.html"><span class="keyword cmdname">mq</span></a>
          server and a queue in kernel space, <span class="ph filepath">libmq</span>: <p class="p"> Use the <span class="keyword option">-l
              mq</span> option to <span class="keyword cmdname">qcc</span> to link against this library. </p>

        </li>


</ul>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">

If <var class="keyword varname">notification</var> isn't <span class="keyword const">NULL</span>, the <span class="keyword apiname">mq_notify()</span> function
asks the server to notify the calling process when the queue makes
the transition from empty to nonempty.  The means by which the server
is to notify the process is passed in the
<a class="xref" href="../s/sigevent.html" title="Structure that describes an event"><span class="keyword dtype">sigevent</span></a>
structure pointed to by <var class="keyword varname">notification</var>.  Once the
message queue server has notified the process of the transition, the
notification is removed.
</p>


<div class="note note"><span class="notetitle">Note:</span> 
<ul class="ul">
<li class="li">The message queue manager needs to be running. <span class="keyword">QNX Neutrino</span> supports two
        implementations of message queues: a traditional implementation, and an alternate one that
        uses the <span class="keyword cmdname">mq</span> server and a queue in kernel space. For more information, see
        the entries for <a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/m/mq.html"><span class="keyword cmdname">mq</span></a> and <a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/m/mqueue.html"><span class="keyword cmdname">mqueue</span></a> in the <cite class="cite">Utilities Reference</cite>, as well as
        the
<a class="xref" href="../../../com.qnx.doc.neutrino.technotes/topic/managing_mq_mqueue.html">POSIX Message Queues: Two Implementations</a>
technote.
</li>


<li class="li">This function accepts registered events (see
  <a class="xref" href="msgregisterevent.html" title="Register a secure event"><span class="keyword apiname">MsgRegisterEvent()</span></a>), but
  for compatibility with POSIX, it also accepts unregistered events, even if the system as a whole
  is required to use registered events (see the <span class="keyword option">-U</span> option for
  <a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/p/procnto.html"><span class="keyword cmdname">procnto</span></a>).
</li>


</ul>

</div>


<p class="p">
We recommend that you use the following event types in this case:
</p>


<ul class="ul">
<li class="li"><span class="keyword const">SIGEV_SIGNAL</span>
  
</li>


<li class="li"><span class="keyword const">SIGEV_SIGNAL_CODE</span>
  
</li>


<li class="li"><span class="keyword const">SIGEV_SIGNAL_THREAD</span>
  
</li>


<li class="li"><span class="keyword const">SIGEV_PULSE</span>
  
</li>


</ul>


<p class="p">
Under normal operation, only one process may register for
notification at a time.  If a process attempts to attach a
notification, and another process is already attached, an error is
returned and <var class="keyword varname">errno</var> is set to <span class="keyword const">EBUSY</span>.
</p>


<p class="p">
If a process has registered for notification, and another process is blocked on
<a class="xref" href="mq_receive.html" title="Receive a message from a queue"><span class="keyword apiname">mq_receive()</span></a>,
then the <span class="keyword apiname">mq_receive()</span> call is satisfied by any arriving message.
The resulting behavior is as if the message queue remained empty.
</p>


<p class="p">
If <var class="keyword varname">notification</var> is <span class="keyword const">NULL</span> and the current
process is currently registered for notification, then the existing
registration is removed.
</p>


</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">
-1 if an error occurred 
(<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a> is set).
Any other value indicates success.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl" compact="compact">

<dt class="dt dlterm"><span class="keyword const">EBADF</span></dt>

<dd class="dd">Invalid message queue <var class="keyword varname">mqdes</var>.</dd>




<dt class="dt dlterm"><span class="keyword const">EBUSY</span></dt>

<dd class="dd">A process has already registered for notification for the given queue.</dd>




<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">The <var class="keyword varname">notification</var> argument is <span class="keyword const">NULL</span>,
  but the process isn't currently registered.
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">POSIX 1003.1 MSG</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d2223119e387">Safety:</th>
<th class="entry" valign="top" id="d2223119e389">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d2223119e387 d2223119e389 ">Cancellation point</td>
<td class="entry" valign="top" headers="d2223119e387 d2223119e389 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2223119e387 d2223119e389 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d2223119e387 d2223119e389 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2223119e387 d2223119e389 ">Signal handler</td>
<td class="entry" valign="top" headers="d2223119e387 d2223119e389 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2223119e387 d2223119e389 ">Thread</td>
<td class="entry" valign="top" headers="d2223119e387 d2223119e389 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>


<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.sys_arch/topic/ipc_Message_queues.html" title="POSIX message queues (System Architecture)">POSIX message queues (System Architecture)</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.technotes/topic/managing_mq_mqueue.html" title="POSIX Message Queues: Two Implementations (Technotes)">POSIX Message Queues: Two Implementations (Technotes)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/i/ionotify.html" title="Arm a resource manager">ionotify()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/mq_open.html" title="Open a message queue">mq_open()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/mq_receive.html" title="Receive a message from a queue">mq_receive()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/mq_send.html" title="Send a message to a queue">mq_send()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgregisterevent.html" title="Register a secure event">MsgRegisterEvent(), MsgRegisterEvent_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sigevent.html" title="Structure that describes an event">sigevent</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.utilities/topic/m/mq.html" title="mq (Utilities Reference)">mq (Utilities Reference)</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.utilities/topic/m/mqueue.html" title="mqueue (Utilities Reference)">mqueue (Utilities Reference)</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">M</span></a></span>  </div>
</body>
</html>