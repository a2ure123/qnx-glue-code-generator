
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="fcntl()" /><meta name="abstract" content="Provide control over an open file" /><meta name="description" content="Provide control over an open file" /><meta name="indexterms" content="fcntl()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-f.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/close.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dup.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dup2.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execl.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execle.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execlp.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execlpe.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execv.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execve.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execvp.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execvpe.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/i/ioctl.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/o/open.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="fcntl" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>fcntl()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="fcntl">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-f.html" title="F">F</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-f.html" title="F"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">F</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">fcntl()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>


<div class="body refbody"><p class="shortdesc"><em class="ph i">Provide control over an open file</em></p>


<div class="section">

<p class="p">



</p>

</div>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;

int fcntl( int <var class="keyword varname">filedes</var>, 
           int <var class="keyword varname">cmd</var>,
           ... );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">filedes</var></dt>

<dd class="dd">The descriptor for the file you want to control.</dd>




<dt class="dt dlterm"><var class="keyword varname">cmd</var></dt>

<dd class="dd">The command to execute; see below.</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>

<p class="p">Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">
The <span class="keyword apiname">fcntl()</span> function provides control over the open file referenced by file descriptor <var class="keyword varname">filedes</var>. 
To establish a lock with this function, open with write-only permission
(<a class="xref" href="../o/open.html#open__O_WRONLY"><span class="keyword const">O_WRONLY</span></a>)
or with read/write permission
(<a class="xref" href="../o/open.html#open__O_RDWR"><span class="keyword const">O_RDWR</span></a>).
</p>


<p class="p">
The type of control is specified by the <var class="keyword varname">cmd</var> argument,
which may require a third data argument (<var class="keyword varname">arg</var>).
The <var class="keyword varname">cmd</var> argument is defined in 
<span class="ph filepath">&lt;fcntl.h&gt;</span>,
and includes at least the following values:
</p>


<div class="note note"><span class="notetitle">Note:</span> 
The <span class="keyword const">F_*64</span> values are defined only if you define <span class="keyword const">_LARGEFILE64_SOURCE</span> when you
compile your code.
For more information, see
<span class="q">&#147;<a class="xref" href="../summary.html#summary__CLASSIFICATION">Classification</a>&#148;</span>
in What's in a Function Description?
</div>


<dl class="dl">

<dt class="dt dlterm" id="fcntl__F_ALLOCSP"><span class="keyword const">F_ALLOCSP</span></dt>

<dd class="dd">Allocate storage space for the section of the file specified by the
  <var class="keyword varname">l_start</var>, <var class="keyword varname">l_len</var>, and <var class="keyword varname">l_whence</var> fields
  of a <span class="keyword dtype">struct flock</span> structure pointed to by the additional
  argument to <span class="keyword apiname">fcntl()</span>
  
  
  
</dd>




<dt class="dt dlterm" id="fcntl__F_ALLOCSP64"><span class="keyword const">F_ALLOCSP64</span></dt>

<dd class="dd">Same as <span class="keyword const">F_ALLOCSP</span>, except that
  the argument is a pointer to a <span class="keyword dtype">struct flock64</span> structure,
  where the <var class="keyword varname">l_start</var> and <var class="keyword varname">l_len</var> fields are 64-bit values.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_DUPFD"><span class="keyword const">F_DUPFD</span></dt>

<dd class="dd">Allocate and return a new file descriptor that's the lowest numbered
  available (i.e., not already open) file descriptor greater than or
  equal to the third argument, <var class="keyword varname">arg</var>, taken as an <span class="keyword dtype">int</span>. 
  The new file descriptor refers to the same file as <var class="keyword varname">filedes</var>, and shares any locks.
  
  
  
</dd>




<dt class="dt dlterm" id="fcntl__F_DUPFD_CLOEXEC"><span class="keyword const">F_DUPFD_CLOEXEC</span></dt>

<dd class="dd">Similar to <span class="keyword const">F_DUPFD</span>, but also sets <span class="keyword const">FD_CLOEXEC</span>.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_FREESP"><span class="keyword const">F_FREESP</span></dt>

<dd class="dd">Free storage space for the section of the file
  specified by the <var class="keyword varname">l_start</var>, <var class="keyword varname">l_len</var>, and
  <var class="keyword varname">l_whence</var> fields of the <span class="keyword dtype">struct flock</span> structure
  pointed to by the additional argument to <span class="keyword apiname">fcntl()</span>.
  
  
  
</dd>




<dt class="dt dlterm" id="fcntl__F_FREESP64"><span class="keyword const">F_FREESP64</span></dt>

<dd class="dd">Same as <span class="keyword const">F_FREESP</span>, except that
  the argument is a pointer to a <span class="keyword dtype">struct flock64</span> structure,
  where the <var class="keyword varname">l_start</var> and <var class="keyword varname">l_len</var> fields are 64-bit values.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_GETFD"><span class="keyword const">F_GETFD</span></dt>

<dd class="dd">Get the file descriptor flags (see <span class="keyword const">F_SETFD</span>, below) associated with the file descriptor
  <var class="keyword varname">filedes</var>. 
  File descriptor flags are associated with a single file descriptor,
  and don't affect other file descriptors referring to the same file.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_GETFL"><span class="keyword const">F_GETFL</span></dt>

<dd class="dd">Get the file status flags and the file access modes associated with <var class="keyword varname">filedes</var>.
  The flags and modes are defined in <span class="ph filepath">&lt;fcntl.h&gt;</span>.
  
  
  

  <p class="p">
  
  The file status flags (identified by the <span class="keyword">QNX Neutrino</span> <span class="keyword const">O_SETFLAG</span> mask) include:
  </p>


  <ul class="ul">
  <li class="li"><a class="xref" href="../o/open.html#open__O_APPEND"><span class="keyword const">O_APPEND</span></a>
    
  </li>


  <li class="li"><a class="xref" href="../o/open.html#open__O_DSYNC"><span class="keyword const">O_DSYNC</span></a>
    
  </li>


  <li class="li"><a class="xref" href="../o/open.html#open__O_LARGEFILE"><span class="keyword const">O_LARGEFILE</span></a>
    
  </li>


  <li class="li"><a class="xref" href="../o/open.html#open__O_NONBLOCK"><span class="keyword const">O_NONBLOCK</span></a>
    
  </li>


  <li class="li"><a class="xref" href="../o/open.html#open__O_RSYNC"><span class="keyword const">O_RSYNC</span></a>
    
  </li>


  <li class="li"><a class="xref" href="../o/open.html#open__O_SYNC"><span class="keyword const">O_SYNC</span></a>
    
  </li>


  </ul>

  
  <p class="p">
  The file access modes are:
  </p>


   
  <ul class="ul">
  <li class="li"><a class="xref" href="../o/open.html#open__O_RDONLY"><span class="keyword const">O_RDONLY</span></a>
    
  </li>


  <li class="li"><a class="xref" href="../o/open.html#open__O_RDWR"><span class="keyword const">O_RDWR</span></a>
    
  </li>


  <li class="li"><a class="xref" href="../o/open.html#open__O_WRONLY"><span class="keyword const">O_WRONLY</span></a>
    
  </li>


  </ul>


  <p class="p">
  For more information, see
  <a class="xref" href="../o/open.html" title="Open a file"><span class="keyword apiname">open()</span></a>.
  </p>

</dd>




<dt class="dt dlterm" id="fcntl__F_GETLK"><span class="keyword const">F_GETLK</span></dt>

<dd class="dd">Get the first lock that blocks the lock description pointed to by the third argument, <var class="keyword varname">arg</var>, 
  taken as a pointer to type <span class="keyword dtype">struct flock</span> (defined in <span class="ph filepath">&lt;fcntl.h&gt;</span>).
  For more information, see the 
  <a class="xref" href="#fcntl__FlockStructure"><span class="keyword dtype">flock</span> structure</a> section below.
  The information returned overwrites the information passed to <span class="keyword apiname">fcntl()</span> 
  in the structure pointed to by <var class="keyword varname">arg</var>. 
  
  
  
  

  <p class="p">
  If no lock is found that prevents this lock from being created, 
  the structure is left unchanged, except for the lock type, which is set to 
  <a class="xref" href="#fcntl__F_UNLCK"><span class="keyword const">F_UNLCK</span></a>. 
  If a lock is found, the <var class="keyword varname">l_pid</var> member of the structure pointed to by <var class="keyword varname">arg</var>
  is set to the process ID of the process holding the blocking lock and 
  <var class="keyword varname">l_whence</var> is set to 
  <a class="xref" href="#fcntl__SEEK_SET"><span class="keyword const">SEEK_SET</span></a>.
  
  
  </p>

</dd>




<dt class="dt dlterm" id="fcntl__F_GETLK64"><span class="keyword const">F_GETLK64</span></dt>

<dd class="dd">Same as <span class="keyword const">F_GETLK</span>, except that
  the argument is a pointer to a <span class="keyword dtype">struct flock64</span> structure,
  where the <var class="keyword varname">l_start</var> and <var class="keyword varname">l_len</var> fields are 64-bit values.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_GETOWN"><span class="keyword const">F_GETOWN</span></dt>

<dd class="dd">If the file descriptor refers to a socket, get the process or process group ID that's
  specified to receive <span class="keyword const">SIGURG</span> signals when out-of-band data is available.
  Positive values indicate a process ID; negative values, other than -1, indicate a process group ID.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_GROWSP"><span class="keyword const">F_GROWSP</span></dt>

<dd class="dd">(QNX Neutrino 7.1 or later) Allocate storage space for the section of the file specified by the
  <var class="keyword varname">l_start</var>, <var class="keyword varname">l_len</var>, and <var class="keyword varname">l_whence</var> fields
  of a <span class="keyword dtype">struct flock</span> structure pointed to by the additional
  argument to <span class="keyword apiname">fcntl()</span>.
  <span class="keyword const">F_GROWSP</span> is similar to <span class="keyword const">F_ALLOCSP</span> but permits lazy allocation by a
  sparse file implementation.
  
  
  
  
  
</dd>




<dt class="dt dlterm" id="fcntl__F_GROWSP64"><span class="keyword const">F_GROWSP64</span></dt>

<dd class="dd">(QNX Neutrino 7.1 or later) Same as <span class="keyword const">F_GROWSP</span>, except that
  the argument is a pointer to a <span class="keyword dtype">struct flock64</span> structure,
  where the <var class="keyword varname">l_start</var> and <var class="keyword varname">l_len</var> fields are 64-bit values.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_SETFD"><span class="keyword const">F_SETFD</span></dt>

<dd class="dd">Set the file descriptor flags associated with <var class="keyword varname">filedes</var>
  to the third argument, <var class="keyword varname">arg</var>, taken as type <span class="keyword dtype">int</span>. 
  The only defined file descriptor flag is:
  

  <dl class="dl">
  
  <dt class="dt dlterm"><span class="keyword const">FD_CLOEXEC</span></dt>

  <dd class="dd">If this flag is set, the file descriptor is closed across <span class="keyword apiname">exec*()</span>,
    <span class="keyword apiname">posix_spawn*()</span>, or <span class="keyword apiname">spawn*()</span> calls; else the file descriptor remains open.
    
    
  </dd>

  

  </dl>

</dd>




<dt class="dt dlterm" id="fcntl__F_SETFL"><span class="keyword const">F_SETFL</span></dt>

<dd class="dd">Set the file status flags, as shown for <span class="keyword const">F_GETFL</span> above, for the open file
  description associated with <var class="keyword varname">filedes</var> from the corresponding
  bits in the third argument, <var class="keyword varname">arg</var>, taken as type <span class="keyword dtype">int</span>.
  You can't use this function to change the file access mode. 
  All bits set in <var class="keyword varname">arg</var>, other than the file status bits, are ignored.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></dt>

<dd class="dd">Set or clear a file segment lock, according to the lock description
  pointed to by the third argument, <var class="keyword varname">arg</var>, taken as a pointer to
  type <span class="keyword dtype">struct flock</span>, as defined in the header file
  <span class="ph filepath">&lt;fcntl.h&gt;</span>, and documented below. 
  This command is used to create the following locks (defined in <span class="ph filepath">&lt;fcntl.h&gt;</span>):
  
  
  

  <dl class="dl" compact="compact">
  
  <dt class="dt dlterm" id="fcntl__F_RDLCK"><span class="keyword const">F_RDLCK</span></dt>

  <dd class="dd">Shared or read locks.
    
  </dd>

  

  
  <dt class="dt dlterm" id="fcntl__F_UNLCK"><span class="keyword const">F_UNLCK</span></dt>

  <dd class="dd">Remove either type of lock.
    
  </dd>

  

  
  <dt class="dt dlterm" id="fcntl__F_WRLCK"><span class="keyword const">F_WRLCK</span></dt>

  <dd class="dd">Exclusive or write locks.
    
  </dd>

  

  </dl>


  <p class="p">
  If a lock can't be set, <span class="keyword apiname">fcntl()</span> returns immediately.
  </p>

</dd>




<dt class="dt dlterm" id="fcntl__F_SETLK64"><span class="keyword const">F_SETLK64</span></dt>

<dd class="dd">Same as <span class="keyword const">F_SETLK</span>, except that
  the argument is a pointer to a <span class="keyword dtype">struct flock64</span> structure,
  where the <var class="keyword varname">l_start</var> and <var class="keyword varname">l_len</var> fields are 64-bit values.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_SETLKW"><span class="keyword const">F_SETLKW</span></dt>

<dd class="dd">This command is the same as 
  <a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></a>,
  except that when a lock is blocked by other locks, the process waits until the request can be satisfied. 
  If a signal that's to be caught is received while <span class="keyword apiname">fcntl()</span> is waiting for a region, 
  the call is interrupted without performing the lock operation, and <span class="keyword apiname">fcntl()</span>
  returns -1 with <var class="keyword varname">errno</var> set to <span class="keyword const">EINTR</span>.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_SETLKW64"><span class="keyword const">F_SETLKW64</span></dt>

<dd class="dd">Same as <span class="keyword const">F_SETLKW</span>, except that
  the argument is a pointer to a <span class="keyword dtype">struct flock64</span> structure,
  where the <var class="keyword varname">l_start</var> and <var class="keyword varname">l_len</var> fields are 64-bit values.
  
</dd>




<dt class="dt dlterm" id="fcntl__F_SETOWN"><span class="keyword const">F_SETOWN</span></dt>

<dd class="dd">If the file descriptor refers to a socket, set the process or process group ID that
  you want to receive <span class="keyword const">SIGURG</span> signals when out-of-band data is available,
  to the value of the third argument, interpreted as an integer.
  Positive values indicate a process ID; negative values, other than -1, indicate a process group ID.
  
</dd>



</dl>


<div class="note note"><span class="notetitle">Note:</span> 
In QNX Neutrino 6.6 or later, the large-file support functions and data types
appear in the name space only if you define <span class="keyword const">_LARGEFILE64_SOURCE</span> when you compile your code.
For more information, see
<span class="q">&#147;<a class="xref" href="../summary.html#summary__CLASSIFICATION">Classification</a>&#148;</span>
in What's in a Function Description?
</div>


<p class="p" id="fcntl__FlockStructure"><strong class="ph b"><span class="keyword dtype">flock</span> structure</strong></p>


<p class="p">


The <span class="keyword dtype">flock</span> structure (also known as <span class="keyword dtype">flock_t</span>) contains at least the following members:
</p>


<dl class="dl">

<dt class="dt dlterm"><span class="keyword dtype">short</span> <var class="keyword varname">l_type</var></dt>

<dd class="dd">One of 
  <a class="xref" href="#fcntl__F_RDLCK"><span class="keyword const">F_RDLCK</span></a>, 
  <a class="xref" href="#fcntl__F_WRLCK"><span class="keyword const">F_WRLCK</span></a> or 
  <a class="xref" href="#fcntl__F_UNLCK"><span class="keyword const">F_UNLCK</span></a>.

  <p class="p">
  
  <span class="keyword">QNX Neutrino</span> uses this structure for both
  <a class="xref" href="flock.html" title="Apply or remove an advisory lock on an open file"><span class="keyword apiname">flock()</span></a>
  and the <span class="keyword const">F_GETLK*</span> and <span class="keyword const">F_SETLK*</span> commands for <span class="keyword apiname">fcntl()</span>.
  In QNX Neutrino 7.0 or later, and as a <span class="keyword">QNX Neutrino</span> extension,
  if the structure is for a call to <span class="keyword apiname">flock()</span>, this member has
  <span class="keyword const">F_FLOCK</span> ORed into it.
  For more information, see the entry for
  <a class="xref" href="../i/iofunc_lock.html" title="Lock a resource"><span class="keyword apiname">iofunc_lock()</span></a>.
  </p>

</dd>




<dt class="dt dlterm"><span class="keyword dtype">short</span> <var class="keyword varname">l_whence</var></dt>

<dd class="dd">One of the following flags that specify where the relative offset, <var class="keyword varname">l_start</var>, is measured from:

  <dl class="dl" compact="compact">
  
  <dt class="dt dlterm" id="fcntl__SEEK_CUR"><span class="keyword const">SEEK_CUR</span></dt>

  <dd class="dd">Current seek position.
    
  </dd>

  

  
  <dt class="dt dlterm" id="fcntl__SEEK_END"><span class="keyword const">SEEK_END</span></dt>

  <dd class="dd">End of file.
    
  </dd>

  

  
  <dt class="dt dlterm" id="fcntl__SEEK_SET"><span class="keyword const">SEEK_SET</span></dt>

  <dd class="dd">Start of file.
    
  </dd>

  

  </dl>

</dd>




<dt class="dt dlterm"><span class="keyword dtype">off_t</span> <var class="keyword varname">l_start</var></dt>

<dd class="dd">Relative offset in bytes.</dd>




<dt class="dt dlterm"><span class="keyword dtype">off_t</span> <var class="keyword varname">l_len</var></dt>

<dd class="dd">Consecutive bytes to lock; if 0, then until EOF; if negative, the
  preceding bytes up to, but not including, the start byte.
</dd>




<dt class="dt dlterm"><span class="keyword dtype">pid_t</span> <var class="keyword varname">l_pid</var></dt>

<dd class="dd">Process ID of the process holding the lock, returned when 
  <var class="keyword varname">cmd</var> is 
  <a class="xref" href="#fcntl__F_GETLK"><span class="keyword const">F_GETLK</span></a>.
</dd>



</dl>


<p class="p">
When a shared lock is set on a segment of a file, other processes can
set shared locks on the same segment, or a portion of it. A shared
lock prevents other processes from setting exclusive locks on any
portion of the protected area. A request for a shared lock fails
if the file was opened write-only.
</p>


<p class="p">
An exclusive lock prevents any other process from setting a shared or
an exclusive lock on a portion of the protected area. 
A request for an exclusive lock fails if the file was opened read-only.
</p>


<p class="p">
Locks may start and extend beyond the current end of file, 
but may not start or extend before the beginning of the file; 
to attempt to do so is an error. 
A lock extends to <span class="q">&#147;infinity&#148;</span> (the largest possible 
value for the file offset) if <var class="keyword varname">l_len</var> is set to zero. 
If <var class="keyword varname">l_whence</var> and <var class="keyword varname">l_start</var> point to the beginning of the file, 
and <var class="keyword varname">l_len</var> is zero, the entire file is locked.
</p>


<p class="p">
The calling process may have only one type of lock set for each byte of a file. 
Before successfully returning from an 
<a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></a>
or
<a class="xref" href="#fcntl__F_SETLKW"><span class="keyword const">F_SETLKW</span></a> 
request, the previous lock type (if any) for each
byte in the specified lock region is replaced by the new lock type.
All locks associated with a file for a given process are removed when
a file descriptor for that file is closed by the process, or the
process holding the file descriptor terminates. 
Locks aren't inherited by a child process using the <span class="keyword apiname">fork()</span> function.
However, locks are inherited across <span class="keyword apiname">exec*()</span> or <span class="keyword apiname">spawn*()</span> calls.
</p>


<div class="note note"><span class="notetitle">Note:</span> 
<ul class="ul">
<li class="li">
A potential for deadlock occurs if a process controlling a locked
region is put to sleep by attempting to lock another process's locked region. 
  There's no detection for deadlocks involving file locks.
</li>


<li class="li">
Locking is a protocol designed for updating a file shared among
concurrently running applications.
Locks are only advisory, that is, they don't prevent an errant or
poorly-designed application from overwriting a locked region of a
shared file.
An application should use locks to indicate regions of a file that are
to be updated by the application, and it should respect the locks of
other applications.

<p class="p">
The following functions ignore locks:
</p>


<ul class="ul">
<li class="li"><a class="xref" href="../l/ltrunc.html" title="Truncate a file at a given position"><span class="keyword apiname">ltrunc()</span></a></li>

<li class="li"><a class="xref" href="../o/open.html" title="Open a file"><span class="keyword apiname">open()</span></a></li>

<li class="li"><a class="xref" href="../r/read.html" title="Read bytes from a file"><span class="keyword apiname">read()</span></a></li>

<li class="li"><a class="xref" href="../s/sopen.html" title="Open a file for shared access"><span class="keyword apiname">sopen()</span></a></li>

<li class="li"><a class="xref" href="../w/write.html" title="Write bytes to a file"><span class="keyword apiname">write()</span></a></li>

</ul>

</li>


</ul>

</div>


</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">
-1 if an error occurred (<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a> is set).
The successful return value(s) depend on the
request type specified by <var class="keyword varname">arg</var>, as shown below:
</p>


<dl class="dl" compact="compact">

<dt class="dt dlterm"><a class="xref" href="#fcntl__F_DUPFD"><span class="keyword const">F_DUPFD</span></a></dt>

<dd class="dd">A new file descriptor.</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_GETFD"><span class="keyword const">F_GETFD</span></a></dt>

<dd class="dd">Value of the file descriptor flags (never a negative value).</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_GETFL"><span class="keyword const">F_GETFL</span></a></dt>

<dd class="dd">Value of the file status flags and access modes as shown above (never a negative value).</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_GETLK"><span class="keyword const">F_GETLK</span></a></dt>

<dd class="dd">Value other than -1.</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_GETOWN"><span class="keyword const">F_GETOWN</span></a></dt>

<dd class="dd">Positive values indicate a process ID; negative values (other than -1) indicate a process group ID.</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_SETFD"><span class="keyword const">F_SETFD</span></a></dt>

<dd class="dd">Value other than -1.

  <p class="p">
  (QNX Neutrino 7.0.4 or later) As a <span class="keyword">QNX Neutrino</span> extension, the value returned on
  success is 0.
  </p>

</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_SETFL"><span class="keyword const">F_SETFL</span></a></dt>

<dd class="dd">Value other than -1.</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></a></dt>

<dd class="dd">Value other than -1.</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_SETLKW"><span class="keyword const">F_SETLKW</span></a></dt>

<dd class="dd">Value other than -1.</dd>




<dt class="dt dlterm"><a class="xref" href="#fcntl__F_SETOWN"><span class="keyword const">F_SETOWN</span></a></dt>

<dd class="dd">Value other than -1.</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl">

<dt class="dt dlterm"><span class="keyword const">EAGAIN</span></dt>

<dd class="dd">The <var class="keyword varname">cmd</var> argument is 
  <a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></a>,
  the type of lock (<var class="keyword varname">l_type</var>) is a shared lock 
  (<a class="xref" href="#fcntl__F_RDLCK"><span class="keyword const">F_RDLCK</span></a>),
  and the segment of a file to be locked is already exclusive-locked by another process, 
  or the type is an exclusive lock and some portion of 
  the segment of a file to be locked is already shared-locked or 
  exclusive-locked by another process.
</dd>




<dt class="dt dlterm"><span class="keyword const">EBADF</span></dt>

<dd class="dd">One of the following occurred:

  <ul class="ul">
  <li class="li">The <var class="keyword varname">filedes</var> argument isn't a valid file descriptor.</li>


  <li class="li">The <var class="keyword varname">cmd</var> argument is 
    <a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></a> or 
    <a class="xref" href="#fcntl__F_SETLKW"><span class="keyword const">F_SETLKW</span></a>, 
    the type of lock (<var class="keyword varname">l_type</var>) is a shared lock 
    (<a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_RDLCK</span></a>), 
    and <var class="keyword varname">filedes</var> isn't a valid file descriptor open for reading.
  </li>


  <li class="li">The <var class="keyword varname">cmd</var> argument is 
    <a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></a> or 
    <a class="xref" href="#fcntl__F_SETLKW"><span class="keyword const">F_SETLKW</span></a>, 
    the type of lock (<var class="keyword varname">l_type</var>) is an exclusive lock 
    (<a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_WRLCK</span></a>),
    and <var class="keyword varname">filedes</var> isn't a valid file descriptor open for writing.
  </li>


  </ul>

</dd>




<dt class="dt dlterm"><span class="keyword const">EINTR</span></dt>

<dd class="dd">The <var class="keyword varname">cmd</var> argument is 
  <a class="xref" href="#fcntl__F_SETLKW"><span class="keyword const">F_SETLKW</span></a>, 
  and the function was interrupted by a signal.
</dd>




<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">One of the following occurred:

  <ul class="ul">
  <li class="li">The <var class="keyword varname">cmd</var> argument is invalid.</li>


  <li class="li">The <var class="keyword varname">cmd</var> argument is
    <a class="xref" href="#fcntl__F_DUPFD"><span class="keyword const">F_DUPFD</span></a>, 
    and the third argument is negative, 
    or greater than the configured number of maximum open file descriptors per process.
  </li>


  <li class="li">The <var class="keyword varname">cmd</var> argument is 
    <a class="xref" href="#fcntl__F_GETLK"><span class="keyword const">F_GETLK</span></a>, 
    <a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></a> 
    or 
    <a class="xref" href="#fcntl__F_SETLKW"><span class="keyword const">F_SETLKW</span></a>,
    and the data <var class="keyword varname">arg</var> isn't valid, 
    or <var class="keyword varname">filedes</var> refers to a file that doesn't support locking.
  </li>


  <li class="li">The <var class="keyword varname">cmd</var> argument is 
    <a class="xref" href="#fcntl__F_SETFL"><span class="keyword const">F_SETFL</span></a>, 
    and you specified one of the <span class="keyword const">*SYNC</span> flags, but <span class="keyword const">IOFUNC_PC_SYNC_IO</span> isn't set
    in the filesystem's mount configuration.
    
  </li>


  </ul>

</dd>




<dt class="dt dlterm"><span class="keyword const">EMFILE</span></dt>

<dd class="dd">The <var class="keyword varname">cmd</var> argument is 
  <a class="xref" href="#fcntl__F_DUPFD"><span class="keyword const">F_DUPFD</span></a>, 
  and all file descriptors available to the process are open, 
  or no file descriptors greater than or equal to <var class="keyword varname">arg</var> are available.
</dd>




<dt class="dt dlterm"><span class="keyword const">ENOLCK</span></dt>

<dd class="dd">The <var class="keyword varname">cmd</var> argument is 
  <a class="xref" href="#fcntl__F_SETLK"><span class="keyword const">F_SETLK</span></a>
  or 
  <a class="xref" href="#fcntl__F_SETLKW"><span class="keyword const">F_SETLKW</span></a>, 
  and satisfying the lock or unlock request causes the number of lock regions 
  in the system to exceed the system-imposed limit.
</dd>




<dt class="dt dlterm"><span class="keyword const">ENOSYS</span></dt>

<dd class="dd">The filesystem doesn't support the operation.</dd>




<dt class="dt dlterm"><span class="keyword const">EOVERFLOW</span></dt>

<dd class="dd">One of the values to be returned can't be represented correctly.</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Examples:</h2>


<pre class="pre codeblock">
/*
 * This program makes "stdout" synchronous
 * to guarantee the data is recoverable
 * (if it's redirected to a file).
 */
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main( void )
{
    int flags, retval;

    flags = fcntl( STDOUT_FILENO, F_GETFL );

    flags |= O_DSYNC;

    retval = fcntl( STDOUT_FILENO, F_SETFL, flags );
    if( retval == -1 ) {
        printf( "error setting stdout flags\n" );
        return EXIT_FAILURE;
    }

    printf( "Hello, <span class="keyword">QNX Neutrino</span> world.\n" );

    return EXIT_SUCCESS;
}
</pre>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">POSIX 1003.1</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d1419153e1811">Safety:</th>
<th class="entry" valign="top" id="d1419153e1813">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d1419153e1811 d1419153e1813 ">Cancellation point</td>
<td class="entry" valign="top" headers="d1419153e1811 d1419153e1813 ">Read the <em class="ph i">Caveats</em></td>
</tr>

<tr><td class="entry" valign="top" headers="d1419153e1811 d1419153e1813 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d1419153e1811 d1419153e1813 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1419153e1811 d1419153e1813 ">Signal handler</td>
<td class="entry" valign="top" headers="d1419153e1811 d1419153e1813 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d1419153e1811 d1419153e1813 ">Thread</td>
<td class="entry" valign="top" headers="d1419153e1811 d1419153e1813 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>



<div class="section"><h2 class="title sectiontitle">Caveats:</h2>


<p class="p">
A cancellation point occurs when a thread is executing <span class="keyword apiname">fcntl()</span> if the
<var class="keyword varname">cmd</var> argument is <span class="keyword const">F_SETLKW</span>;
a cancellation point may occur in the case of 
<a class="xref" href="#fcntl__F_DUPFD"><span class="keyword const">F_DUPFD</span></a>
(when dupping across the network),
<a class="xref" href="#fcntl__F_GETFD"><span class="keyword const">F_GETFD</span></a>, 
and
<a class="xref" href="#fcntl__F_SETFD"><span class="keyword const">F_SETFD</span></a>.
</p>

</div>


</div>


<div class="related-links"><div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/close.html" title="Close a file">close()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dup.html" title="Duplicate a file descriptor">dup()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dup2.html" title="Duplicate a file descriptor, specifying the new descriptor">dup2()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execl.html" title="Execute a file">execl()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execle.html" title="Execute a file">execle()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execlp.html" title="Execute a file">execlp()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execlpe.html" title="Execute a file">execlpe()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execv.html" title="Execute a file">execv()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execve.html" title="Execute a file">execve()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execvp.html" title="Execute a file">execvp()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/execvpe.html" title="Execute a file">execvpe()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/i/ioctl.html" title="Control a device">ioctl(), vioctl()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/o/open.html" title="Open a file">open(), open64()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-f.html" title="F"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">F</span></a></span>  </div>
</body>
</html>