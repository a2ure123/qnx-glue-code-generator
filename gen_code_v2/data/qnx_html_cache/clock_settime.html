
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="clock_settime()" /><meta name="abstract" content="Set a clock" /><meta name="description" content="Set a clock" /><meta name="indexterms" content="clock_settime()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.getting_started/topic/s1_timer.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_getres.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_gettime.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clocktime.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/errno.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/mktime.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/procmgr_ability.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/t/timespec.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="clock_settime" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>clock_settime()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="clock_settime">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C">C</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">C</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">clock_settime()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>


<div class="body refbody"><p class="shortdesc"><em class="ph i">Set a clock</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;time.h&gt;

int clock_settime( clockid_t <var class="keyword varname">id</var>,
                   const struct timespec * <var class="keyword varname">tp</var> );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">id</var></dt>

<dd class="dd"><span class="keyword const">CLOCK_REALTIME</span>, the ID of the clock that maintains the system time.
  
  

  <p class="p">
  For more information about the different clocks, see 
  <span class="q">&#147;<a class="xref" href="../../../com.qnx.doc.neutrino.getting_started/topic/s1_timer_otherclock.html">Other clock sources</a>&#148;</span>
  in the Clocks, Timers, and Getting a Kick Every So Often of
  <cite class="cite">Getting Started with <span class="keyword">QNX Neutrino</span></cite>.
  </p>

</dd>




<dt class="dt dlterm"><var class="keyword varname">tp</var></dt>

<dd class="dd">A pointer to a
  <a class="xref" href="../t/timespec.html" title="Time-specification structure"><span class="keyword dtype">timespec</span></a>
  structure containing at least the following members:

  <ul class="ul">
  <li class="li"><var class="keyword varname">tv_sec</var> â the number of seconds since 1970.</li>


  <li class="li"><var class="keyword varname">tv_nsec</var> â the number of nanoseconds in the current second.
    This value increases by some multiple of nanoseconds, based on the system clock's resolution.
  </li>


  </ul>

</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>


<p class="p">
Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">
The <span class="keyword apiname">clock_settime()</span> function sets the clock specified by 
<var class="keyword varname">id</var> to the time specified in the buffer pointed to by
<var class="keyword varname">tp</var>.



</p>


<div class="note note"><span class="notetitle">Note:</span> 
<ul class="ul">
<li class="li">Be careful if you set the date during the period that a time zone is switching from
  daylight saving time (DST) to standard time.
  When a time zone changes to standard time, the local time goes back one hour
  (for example, 2:00 a.m. becomes 1:00 a.m.).
  The local time during this hour is ambiguous (e.g., 1:14 a.m. occurs twice
  in the morning that the time zone switches to standard time).
  To avoid problems, use UTC time to set the date in this period.
</li>


<li class="li">You can't set the time when the <var class="keyword varname">id</var> is <span class="keyword const">CLOCK_MONOTONIC</span>.</li>


<li class="li">In order to set the clock, your process must have the
  <span class="keyword const">PROCMGR_AID_CLOCKSET</span> ability enabled.
  For more information, see
  <a class="xref" href="../p/procmgr_ability.html" title="Control a process's ability to perform certain operations"><span class="keyword apiname">procmgr_ability()</span></a>.
  
</li>


</ul>

</div>


<p class="p">
If you change the time for <span class="keyword const">CLOCK_REALTIME</span>,
the change occurs immediately, and the expiry time for some timers might end up in the past.
In this case, the timers will expire on the next clock tick.
If you need the affected timers to expire before the next clock tick,
then before changing the time, set a high-resolution timer to expire just after the new time;
after you change the time, the high-resolution timer will expire and so will all the affected timers.
</p>


</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<dl class="dl">

<dt class="dt dlterm">0</dt>

<dd class="dd">Success</dd>




<dt class="dt dlterm">-1</dt>

<dd class="dd">An error occurred 
  (<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a>
  is set).
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl" compact="compact">

<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">One of the following occurred:

  <ul class="ul">
  <li class="li">The <var class="keyword varname">id</var> is invalid.
    You can't set the time for <span class="keyword const">CLOCK_MONOTONIC</span>.
  </li>


  <li class="li">The number of nanoseconds specified
    by the <var class="keyword varname">tv_nsec</var> member is less than zero or greater than
    or equal to 1000 million.
  </li>


  <li class="li">The <var class="keyword varname">tv_sec</var> member is -1 (which could happen if
    you set it to the result from
    <a class="xref" href="../m/mktime.html" title="Convert local time to calendar time"><span class="keyword apiname">mktime()</span></a>
    without checking to see if the call succeeded).
  </li>


  </ul>

</dd>




<dt class="dt dlterm"><span class="keyword const">EPERM</span></dt>

<dd class="dd">One of the following occurred:

  <ul class="ul">
  <li class="li">The calling process doesn't have the required permission; see
    <a class="xref" href="../p/procmgr_ability.html" title="Control a process's ability to perform certain operations"><span class="keyword apiname">procmgr_ability()</span></a>.
  </li>


  <li class="li">You tried to set the time for a process or thread CPU-time clock.</li>


  </ul>

</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Examples:</h2>


<pre class="pre codeblock">
/*  This program sets the clock forward 1 day. */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;time.h&gt;

int main( void )
  {
    struct timespec stime;

    if( clock_gettime( CLOCK_REALTIME, &amp;stime) == -1 ) {
       perror( "getclock" );
       return EXIT_FAILURE;
    }

    stime.tv_sec += (60*60)*24L;  /* Add one day */
    stime.tv_nsec = 0;
    if( clock_settime( CLOCK_REALTIME, &amp;stime) == -1 ) {
       perror( "setclock" );
       return EXIT_FAILURE;
    }
    return EXIT_SUCCESS;
  }
</pre>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">POSIX 1003.1</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d1298115e340">Safety:</th>
<th class="entry" valign="top" id="d1298115e342">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d1298115e340 d1298115e342 ">Cancellation point</td>
<td class="entry" valign="top" headers="d1298115e340 d1298115e342 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1298115e340 d1298115e342 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d1298115e340 d1298115e342 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1298115e340 d1298115e342 ">Signal handler</td>
<td class="entry" valign="top" headers="d1298115e340 d1298115e342 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d1298115e340 d1298115e342 ">Thread</td>
<td class="entry" valign="top" headers="d1298115e340 d1298115e342 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>





<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.getting_started/topic/s1_timer.html" title="Clocks, Timers, and Getting a Kick Every So Often (Getting Started with QNX Neutrino)">Clocks, Timers, and Getting a Kick Every So Often (Getting Started with <span class="keyword">QNX Neutrino</span>)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_getres.html" title="Get the resolution of the clock">clock_getres()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clock_gettime.html" title="Get the current time of a clock">clock_gettime()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/clocktime.html" title="Get or set a clock">ClockTime(), ClockTime_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/errno.html" title="Thread-local error variable">errno</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/mktime.html" title="Convert local time to calendar time">mktime()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/procmgr_ability.html" title="Control a process's ability to perform certain operations">procmgr_ability()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/t/timespec.html" title="Time-specification structure">timespec</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">C</span></a></span>  </div>
</body>
</html>