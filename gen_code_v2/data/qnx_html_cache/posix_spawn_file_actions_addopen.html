
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="posix_spawn_file_actions_addopen()" /><meta name="abstract" content="Add an &#147;open a file&#148; action to a spawn file action object" /><meta name="description" content="Add an &#147;open a file&#148; action to a spawn file action object" /><meta name="indexterms" content="posix_spawn_file_actions_addopen()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-p.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.getting_started/topic/s1_procs.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/o/open.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn_file_actions_addclose.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn_file_actions_adddup2.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn_file_actions_destroy.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn_file_actions_init.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="posix_spawn_file_actions_addopen" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>posix_spawn_file_actions_addopen()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="posix_spawn_file_actions_addopen">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-p.html" title="P">P</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-p.html" title="P"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">P</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">posix_spawn_file_actions_addopen()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>



<div class="body refbody"><p class="shortdesc">
<em class="ph i">Add an <span class="q">&#147;open a file&#148;</span> action to a spawn file action object</em>
</p>


<div class="section">
<p class="p">







</p>

</div>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>


<pre class="pre codeblock">
#include &lt;spawn.h&gt;

int posix_spawn_file_actions_addopen(
       posix_spawn_file_actions_t *_Restrict <var class="keyword varname">fact_p</var>,
       int <var class="keyword varname">new_fd</var>,
       const char *_Restrict <var class="keyword varname">path</var>,
       int <var class="keyword varname">oflags</var>,
       mode_t <var class="keyword varname">omode</var>);
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">fact_p</var></dt>

<dd class="dd">A pointer to the spawn file actions object that you want to update.
  You must have already initialized this object by calling
  <a class="xref" href="posix_spawn_file_actions_init.html" title="Initialize a spawn file actions object"><span class="keyword apiname">posix_spawn_file_actions_init()</span></a>.
</dd>




<dt class="dt dlterm"><var class="keyword varname">new_fd</var></dt>

<dd class="dd">The number that you want to use for the new file descriptor.</dd>




<dt class="dt dlterm"><var class="keyword varname">path</var></dt>

<dd class="dd">The name of the file to open. The string described by <var class="keyword varname">path</var> is
  copied by the <span class="keyword apiname">posix_spawn_file_actions_addopen()</span> function.
</dd>




<dt class="dt dlterm"><var class="keyword varname">oflags</var></dt>

<dd class="dd">Flags that specify the status and access modes of the file.</dd>




<dt class="dt dlterm"><var class="keyword varname">omode</var></dt>

<dd class="dd">An object of type <span class="keyword dtype">mode_t</span> that specifies the access mode to use for a
  newly created file.
  For more information, see <span class="q">&#147;Access permissions&#148;</span> in the documentation for
  <a class="xref" href="../s/stat.html" title="Get information about a file or directory, given a path"><span class="keyword apiname">stat()</span></a>,
  and the description of <span class="keyword const">O_CREAT</span> in the documentation for
  <a class="xref" href="../o/open.html" title="Open a file"><span class="keyword apiname">open()</span></a>.
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>


<p class="p">
Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">
The <span class="keyword apiname">posix_spawn_file_actions_addopen()</span> function adds an open action
to the object referenced by <var class="keyword varname">fact_p</var> that causes the file named by
<var class="keyword varname">path</var> to be opened (as if
<samp class="ph codeph">open(</samp><var class="keyword varname">path</var><samp class="ph codeph">, </samp><var class="keyword varname">oflag</var><samp class="ph codeph">,
</samp><var class="keyword varname">mode</var>) had been called, and the returned file descriptor,
if not already <var class="keyword varname">new_fd</var>, had been changed to <var class="keyword varname">new_fd</var>)
when a new process is spawned using this file actions object. If <var class="keyword varname">new_fd</var> was
already an open file descriptor, it will be closed before the new file is opened.
</p>


<p class="p">
Files that need to be opened for use by the spawned process can alternatively be handled either
by having the calling process
open them before the <span class="keyword apiname">posix_spawn()</span> or <span class="keyword apiname">posix_spawnp()</span>
call (and close them after), or by passing filenames to the spawned process (in
<var class="keyword varname">argv</var>) so that it may open them itself.
</p>


<p class="p">
Note that the spawn open file action provides to <span class="keyword apiname">posix_spawn()</span> and
<span class="keyword apiname">posix_spawnp()</span> the same capability that the shell redirection operators
provide to <span class="keyword apiname">system()</span>, only without the intervening execution of a shell;
for example:
</p>


<pre class="pre codeblock">
system ("myprog &lt;file1 3&lt;file2");
</pre>


<p class="p">
If the calling process needs to open one or more files for access by the spawned process,
but has insufficient spare file descriptors, then the open action is necessary to allow the
<span class="keyword apiname">open()</span> to occur in the context of the child process after other file
descriptors have been closed (that must remain open in the parent). Additionally, if a
parent is executed from a file having a <span class="q">&#147;set-user-id&#148;</span> mode bit set and the
<span class="keyword const">POSIX_SPAWN_RESETIDS</span> flag is set in the spawn attributes (see
<a class="xref" href="posix_spawn.html" title="Spawn a process"><span class="keyword apiname">posix_spawn()</span></a>),
a file created within the parent process will (possibly incorrectly) have the parent's effective user ID as
its owner, whereas a file created with an <span class="keyword apiname">open()</span> action during
<span class="keyword apiname">posix_spawn()</span> or <span class="keyword apiname">posix_spawnp()</span> will have the
parent's real ID as its owner; an open action by the parent process may successfully
open a file to which the real user should not have access, or fail to open a file to which
the real user should have access.
</p>


</div>


<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<dl class="dl">

<dt class="dt dlterm"><span class="keyword const">EOK</span></dt>

  <dd class="dd">Success.</dd>




<dt class="dt dlterm"><span class="keyword const">EBADF</span></dt>

<dd class="dd">The value specified by <var class="keyword varname">new_fd</var> is negative or greater than or equal to {<span class="keyword const">OPEN_MAX</span>}.
  
</dd>




<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">An argument was invalid, or the value specified by <var class="keyword varname">fact_p</var> was invalid.</dd>




<dt class="dt dlterm"><span class="keyword const">ENOMEM</span></dt>

<dd class="dd">Insufficient memory exists to add to the spawn file actions object.
</dd>



</dl>


<p class="p">
It isn't considered an error if the <var class="keyword varname">new_fd</var> argument specifies a file
descriptor for which the specified operation couldn't be performed at the time of the call.
This type of error isn't detected when the associated file actions object is later
used during a <span class="keyword apiname">posix_spawn()</span> or <span class="keyword apiname">posix_spawnp()</span> operation.
</p>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>


<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">POSIX 1003.1 SPN</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr>
  <th class="entry" valign="top" id="d2330320e401">Safety:</th>

  <th class="entry" valign="top" id="d2330320e404">Â </th>

</tr>

</thead>



<tbody class="tbody">
<tr>
  <td class="entry" valign="top" headers="d2330320e401 d2330320e404 ">Cancellation point</td>

  <td class="entry" valign="top" headers="d2330320e401 d2330320e404 ">No</td>

</tr>

<tr>
  <td class="entry" valign="top" headers="d2330320e401 d2330320e404 ">Interrupt handler</td>

  <td class="entry" valign="top" headers="d2330320e401 d2330320e404 ">Yes</td>

</tr>

<tr>
  <td class="entry" valign="top" headers="d2330320e401 d2330320e404 ">Signal handler</td>

  <td class="entry" valign="top" headers="d2330320e401 d2330320e404 ">Yes</td>

</tr>

<tr>
  <td class="entry" valign="top" headers="d2330320e401 d2330320e404 ">Thread</td>

  <td class="entry" valign="top" headers="d2330320e401 d2330320e404 ">Yes</td>

</tr>


</tbody>

</table>
</div>


</div>


  </div>





<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.getting_started/topic/s1_procs.html" title="Processes and Threads (Getting Started with QNX Neutrino)">Processes and Threads (Getting Started with <span class="keyword">QNX Neutrino</span>)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/o/open.html" title="Open a file">open(), open64()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn.html" title="Spawn a process">posix_spawn(), posix_spawnp()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn_file_actions_addclose.html" title="Add a &#147;close a file descriptor&#148; action to a spawn file actions object">posix_spawn_file_actions_addclose()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn_file_actions_adddup2.html" title="Add a &#147;duplicate a file descriptor&#148; action to a spawn file actions object">posix_spawn_file_actions_adddup2()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn_file_actions_destroy.html" title="Destroy a spawn file actions object">posix_spawn_file_actions_destroy()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/posix_spawn_file_actions_init.html" title="Initialize a spawn file actions object">posix_spawn_file_actions_init()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-p.html" title="P"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">P</span></a></span>  </div>
</body>
</html>