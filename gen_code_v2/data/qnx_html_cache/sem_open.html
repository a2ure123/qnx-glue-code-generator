
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="sem_open()" /><meta name="abstract" content="Create or access a named semaphore" /><meta name="description" content="Create or access a named semaphore" /><meta name="indexterms" content="sem_open()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-s.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.user_guide/topic/limits_Synch.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_close.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_destroy.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_init.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_post.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_trywait.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_unlink.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_wait.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="sem_open" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>sem_open()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="sem_open">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-s.html" title="S">S</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-s.html" title="S"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">S</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">sem_open()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>


<div class="body refbody"><p class="shortdesc"><em class="ph i">Create or access a named semaphore</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;semaphore.h&gt;
#include &lt;fcntl.h&gt;

sem_t * sem_open( const char * <var class="keyword varname">sem_name</var>,
                  int <var class="keyword varname">oflags</var>,
                  ... );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">sem_name</var></dt>

  <dd class="dd">The name of the semaphore that you want to create or access, or <span class="keyword const">SEM_ANON</span> (implies <span class="keyword const">O_ANON</span>, which also implies <span class="keyword const">O_CREAT</span>).</dd>

  <dd class="dd">When you create an anonymous named semaphore (see <a class="xref" href="#sem_open__below">below</a>), this argument is ignored.</dd>




<dt class="dt dlterm"><var class="keyword varname">oflags</var></dt>

<dd class="dd">Flags that affect how the function creates a new semaphore.
  This argument is a combination of:

  <ul class="ul">
    <li class="li"><span class="keyword const">O_ANON</span></li>

  <li class="li"><span class="keyword const">O_CREAT</span></li>

  <li class="li"><span class="keyword const">O_EXCL</span></li>

  </ul>


  <div class="note note"><span class="notetitle">Note:</span> 
  Don't set <var class="keyword varname">oflags</var> to <span class="keyword const">O_RDONLY</span>,
  <span class="keyword const">O_RDWR</span>, or <span class="keyword const">O_WRONLY</span>. 
  According to POSIX, a semaphore's behavior is undefined with these flags. 
  The <span class="keyword">QNX Neutrino</span> libraries silently ignore these options, but they may reduce your
  code's portability.
  </div>


  <p class="p">
    For more information, see <a class="xref" href="#sem_open__below">below</a>.
  </p>

</dd>



</dl>


<p class="p">
If you set <span class="keyword const">O_CREAT</span> in <var class="keyword varname">oflags</var>, you must also
pass the following arguments:
</p>


<dl class="dl">

<dt class="dt dlterm"><span class="keyword dtype">mode_t</span> <var class="keyword varname">mode</var></dt>

<dd class="dd">The semaphore's mode (just like file modes).
  For portability, you should set the read, write, 
  <em class="ph i">and</em> execute bits to the same value.  
  An easy way of doing this is to use the constants from
  <span class="ph filepath">&lt;sys/stat.h&gt;</span>:

  <ul class="ul">
  <li class="li"><span class="keyword const">S_IRWXG</span> for group access.
    
  </li>


  <li class="li"><span class="keyword const">S_IRWXO</span> for other's access.
    
  </li>


  <li class="li"><span class="keyword const">S_IRWXU</span> for your own access.
    
  </li>


  </ul>


  <p class="p">
  For more information, see the entry for
  <a class="xref" href="stat_struct.html" title="Data structure for information about a file or directory"><span class="keyword dtype">struct stat</span></a>.
  </p>

</dd>

  <dd class="dd">When you create an anonymous named semaphore, you must provide this argument, but it is ignored.</dd>




<dt class="dt dlterm"><span class="keyword dtype">unsigned int</span> <var class="keyword varname">value</var></dt>

<dd class="dd">The initial value of the semaphore.  
  A positive value indicates the number of semaphore wait operations (e.g.,
  <a class="xref" href="sem_wait.html" title="Wait on a named or unnamed semaphore"><span class="keyword apiname">sem_wait()</span></a>)
  that will succeed without blocking, and a value of zero indicates that the next semaphore wait operation
  will block the calling thread.
  This value must not exceed <span class="keyword const">SEM_VALUE_MAX</span>.
  
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>


<p class="p">
Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.
</p>


</div>



<div class="section" id="sem_open__below"><h2 class="title sectiontitle">Description:</h2>


<p class="p">



The <span class="keyword apiname">sem_open()</span> function creates or accesses a named semaphore. Semaphores persist as long as the system is up.
</p>

<p class="p">
The <span class="keyword apiname">sem_open()</span> function returns a semaphore descriptor that
you can use with
<a class="xref" href="sem_wait.html" title="Wait on a named or unnamed semaphore"><span class="keyword apiname">sem_wait()</span></a>,
<a class="xref" href="sem_trywait.html" title="Wait on a named or unnamed semaphore, but don't block"><span class="keyword apiname">sem_trywait()</span></a>,
and
<a class="xref" href="sem_post.html" title="Increment a named or unnamed semaphore"><span class="keyword apiname">sem_post()</span></a>.
You can use it until you call
<a class="xref" href="sem_close.html" title="Close a named semaphore"><span class="keyword apiname">sem_close()</span></a>.
You can unlink the semaphore by calling
<a class="xref" href="sem_unlink.html" title="Destroy a named semaphore"><span class="keyword apiname">sem_unlink()</span></a>;
when all processes have unlinked the semaphore, it's destroyed.
</p>


<p class="p">
Named semaphores are always created under <span class="ph filepath">/dev/sem</span>:
</p>


<ul class="ul">
<li class="li">If the <var class="keyword varname">name</var> argument starts with a slash, the semaphore
  is given that name.
</li>


<li class="li">If the <var class="keyword varname">name</var> argument 
  doesn't begin with a slash character, the semaphore is given that name,
  prepended with the current working directory.
</li>


</ul>


<p class="p">
In either case, slash characters other than the leading slash character aren't
interpreted, and the specified name, including these slash characters, is used
to identify the semaphore.
In other words, additional slashes don't create a directory structure under
<span class="ph filepath">/dev/sem</span>.
</p>


<p class="p">
For example, if your current directory is <span class="ph filepath">/tmp</span>:
</p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">

<thead class="thead" align="left">
<tr>
  <th class="entry" valign="top" id="d2577609e362"><var class="keyword varname">name</var></th>

  <th class="entry" valign="top" id="d2577609e366">Pathname space entry</th>

</tr>

</thead>


<tbody class="tbody">

<tr>
  <td class="entry" valign="top" headers="d2577609e362 d2577609e366 "><samp class="ph codeph">/my_sem</samp></td>

  <td class="entry" valign="top" headers="d2577609e362 d2577609e366 "><span class="ph filepath">/dev/sem/my_sem</span></td>

</tr>


<tr>
  <td class="entry" valign="top" headers="d2577609e362 d2577609e366 "><samp class="ph codeph">my_sem</samp></td>

  <td class="entry" valign="top" headers="d2577609e362 d2577609e366 "><span class="ph filepath">/dev/sem/tmp/my_sem</span></td>

</tr>


</tbody>

</table>
</div>


<p class="p">
The <var class="keyword varname">oflags</var> argument is used only for semaphore creation.
When creating a new semaphore, you can set
  <var class="keyword varname">oflags</var> to <span class="keyword const">O_CREAT</span>, (<span class="keyword const">O_CREAT</span>|<span class="keyword const">O_EXCL</span>), or <span class="keyword const">O_ANON</span>:
</p>


<dl class="dl">
  
    <dt class="dt dlterm"><span class="keyword const">O_ANON</span></dt>

    <dd class="dd">Implies <span class="keyword const">O_CREAT</span>. When you're creating a new named semaphore, make it an anonymous named semaphore. 
      
      
    
    </dd>

    <dd class="dd"><p class="p">Anonymous named semaphores don't have a path like other named semaphores (i.e., named semaphores with names), but they do have some advantages over unnamed semaphores. Specifically:</p>

      <ul class="ul">
        <li class="li">A named semaphore (including an anonymous named semaphore) can be posted by a <span class="keyword dtype">sigevent</span> (e.g., returned from an ISR or delivered by a server).</li>

        <li class="li">An anonymous named semaphore can be shared between a parent and a child process across a <a class="xref" href="../f/fork.html" title="Create a new process"><span class="keyword apiname">fork()</span></a> without requiring a shared mapping</li>

      </ul>

      <p class="p">With anonymous named semaphores, the <var class="keyword varname">sem_name</var> and <var class="keyword varname">mode</var> arguments are ignored.</p>

    </dd>

  
 

<dt class="dt dlterm"><span class="keyword const">O_CREAT</span></dt>

<dd class="dd">Create a new named semaphore.  
  If you set this bit, you must provide the <var class="keyword varname">mode</var> and 
  <var class="keyword varname">value</var> arguments to <span class="keyword apiname">sem_open()</span>.
</dd>




<dt class="dt dlterm"><span class="keyword const">O_EXCL</span></dt>

<dd class="dd">When you're creating a new named semaphore, 
  <span class="keyword const">O_EXCL</span> causes <span class="keyword apiname">sem_open()</span> to fail if a semaphore with
  <var class="keyword varname">sem_name</var> already exists. 
  Without <span class="keyword const">O_EXCL</span>, <span class="keyword apiname">sem_open()</span> attaches to an existing semaphore
  or creates a new one if <var class="keyword varname">sem_name</var> doesn't exist.
</dd>



</dl>


<div class="cautiontitle">CAUTION:</div><div class="note caution">Don't mix named semaphore operations 
(<span class="keyword apiname">sem_open()</span> and <span class="keyword apiname">sem_close()</span>) 
with unnamed semaphore operations 
(<span class="keyword apiname">sem_init()</span> and <span class="keyword apiname">sem_destroy()</span>) 
on the same semaphore.</div>


  <h2 class="sectiontitle">The QNX implementation of named semaphores</h2>
  <p class="p">
    Note that the QNX implementation of semaphores differs from the POSIX standard, which requires that <span class="q">&#147;if a process makes multiple
      successful calls to <span class="keyword apiname">sem_open()</span> with the same value for <var class="keyword varname">name</var>, the same semaphore address shall be returned for each such successful call ...&#148;</span>.</p>

  <p class="p">With the QNX implementation of named semaphores, if a process makes multiple successful calls to <span class="keyword apiname">sem_open()</span> with the same value for the name (<var class="keyword varname">sem_name</var>) all calls to the function will return <span class="keyword dtype">sem_t</span> objects that reference the same underlying object. This behavior is as specified in the POSIX standard.</p>

  <p class="p">However, the QNX implementation of named semaphores differs from the behavior specified in the POSIX standard as follows: the semaphore addresses returned for each such successful call to <span class="keyword apiname">sem_open()</span> will be <em class="ph i">unique</em> (i.e, call 1 will return address A, while call 2 will return address B, etc.). This behavior means that, for every semaphore, when you are done with the semaphore you must match the call you made to <span class="keyword apiname">sem_open()</span> with a call to <a class="xref" href="sem_close.html" title="Close a named semaphore"><span class="keyword apiname">sem_close()</span></a>.</p>

 
</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">

A pointer to the created or accessed semaphore, 
or <span class="keyword const">SEM_FAILED</span> for failure
(<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a> is set).
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl" compact="compact">

<dt class="dt dlterm"><span class="keyword const">EACCES</span></dt>

<dd class="dd">Either the named semaphore exists and you don't have permission to access it,
  or you're trying to create a new semaphore and you don't have permission.
</dd>




<dt class="dt dlterm"><span class="keyword const">EEXIST</span></dt>

<dd class="dd">You specified <span class="keyword const">O_CREAT</span> and <span class="keyword const">O_EXCL</span> in <var class="keyword varname">oflags</var>,
  but the semaphore already exists.
</dd>




<dt class="dt dlterm"><span class="keyword const">EINTR</span></dt>

<dd class="dd">The call was interrupted by a signal.</dd>




<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">The <var class="keyword varname">sem_name</var> argument is invalid or, when you're creating a semaphore, 
  <var class="keyword varname">value</var> is greater than <span class="keyword const">SEM_VALUE_MAX</span>.
</dd>




<dt class="dt dlterm"><span class="keyword const">ELOOP</span></dt>

<dd class="dd">Too many levels of symbolic links or prefixes.</dd>




<dt class="dt dlterm"><span class="keyword const">EMFILE</span></dt>

<dd class="dd">The process is using too many files or semaphores.</dd>



  
<dt class="dt dlterm"><span class="keyword const">ENFILE</span></dt>

<dd class="dd">The system ran out of resources and couldn't open the semaphore.</dd>




<dt class="dt dlterm"><span class="keyword const">ENOENT</span></dt>

<dd class="dd">The semaphore identified by the <var class="keyword varname">sem_name</var> argument doesn't exist
  and you didn't specify <span class="keyword const">O_CREAT</span> in <var class="keyword varname">oflags</var>.
</dd>




<dt class="dt dlterm"><span class="keyword const">ENOMEM</span></dt>

<dd class="dd">There isn't enough memory to create the new named semaphore.</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">POSIX 1003.1</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d2577609e776">Safety:</th>
<th class="entry" valign="top" id="d2577609e778">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d2577609e776 d2577609e778 ">Cancellation point</td>
<td class="entry" valign="top" headers="d2577609e776 d2577609e778 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2577609e776 d2577609e778 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d2577609e776 d2577609e778 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2577609e776 d2577609e778 ">Signal handler</td>
<td class="entry" valign="top" headers="d2577609e776 d2577609e778 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2577609e776 d2577609e778 ">Thread</td>
<td class="entry" valign="top" headers="d2577609e776 d2577609e778 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>


<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.user_guide/topic/limits_Synch.html" title="Synchronization primitives (QNX Neutrino User's Guide)">Synchronization primitives (<span class="keyword">QNX Neutrino</span> User's Guide)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_close.html" title="Close a named semaphore">sem_close()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_destroy.html" title="Destroy an unnamed semaphore">sem_destroy()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_init.html" title="Initialize an unnamed semaphore">sem_init()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_post.html" title="Increment a named or unnamed semaphore">sem_post()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_trywait.html" title="Wait on a named or unnamed semaphore, but don't block">sem_trywait()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_unlink.html" title="Destroy a named semaphore">sem_unlink()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/sem_wait.html" title="Wait on a named or unnamed semaphore">sem_wait()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-s.html" title="S"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">S</span></a></span>  </div>
</body>
</html>