
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="MsgRead(), MsgRead_r()" /><meta name="abstract" content="Read data from a message" /><meta name="description" content="Read data from a message" /><meta name="indexterms" content="MsgRead(), MsgRead_r()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.getting_started/topic/s1_msg.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreadv.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreceive.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreceivev.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreply.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreplyv.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgwrite.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgwritev.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="msgread" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>MsgRead(), MsgRead_r()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="msgread">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M">M</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">M</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">MsgRead()</span>, <span class="keyword apiname">MsgRead_r()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>


<div class="body refbody"><p class="shortdesc"><em class="ph i">Read data from a message</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;sys/neutrino.h&gt;

ssize_t MsgRead( int <var class="keyword varname">rcvid</var>, 
                 void* <var class="keyword varname">msg</var>, 
                 size_t <var class="keyword varname">bytes</var>, 
                 size_t <var class="keyword varname">offset</var> );

ssize_t MsgRead_r( int <var class="keyword varname">rcvid</var>, 
                   void* <var class="keyword varname">msg</var>, 
                   size_t <var class="keyword varname">bytes</var>, 
                   size_t <var class="keyword varname">offset</var> );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">rcvid</var></dt>

<dd class="dd">The value returned by <span class="keyword apiname">MsgReceive*()</span> when you received the message.</dd>




<dt class="dt dlterm"><var class="keyword varname">msg</var></dt>

<dd class="dd">A pointer to a buffer where the function can store the data.</dd>




<dt class="dt dlterm"><var class="keyword varname">bytes</var></dt>

<dd class="dd">The number of bytes that you want to read.
  This number must not exceed <span class="keyword const">SSIZE_MAX</span>, or the function will behave unpredictably.
  <p class="p">These functions don't let you read past the end of the thread's message;
    they return the number of bytes actually read.</p>

</dd>




<dt class="dt dlterm"><var class="keyword varname">offset</var></dt>

<dd class="dd">An offset into the thread's send message that indicates where you want to start reading the data.</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>


<p class="p">
Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">



The <span class="keyword apiname">MsgRead()</span> and <span class="keyword apiname">MsgRead_r()</span> kernel calls read data from a
message sent by a thread identified by <var class="keyword varname">rcvid</var>. 
The thread being read from must not have been
replied to and will be in the REPLY-blocked state.
The state of the sending thread doesn't change.
Any thread in the receiving process is free to read the message.
</p>


<p class="p">
These functions are identical except in the way they indicate errors.
See the <a class="xref" href="#msgread__Returns">Returns</a> section for details.
</p>


<p class="p">
If the sending and calling threads are on the same node,
the data transfer occurs immediately and the calling thread doesn't block (see <span class="q">&#147;Blocking states,&#148;</span> below).
</p>


<p class="p">
You'll use these functions in these situations:
</p>


<ul class="ul">
<li class="li">A message is sent consisting of a fixed header and a variable
  amount of data. The header contains the byte count of the data. If the
  data is large and has to be inserted into one or more buffers (like a
  filesystem cache), rather than read the data into one large buffer
  and then copy it into several other buffers, <span class="keyword apiname">MsgReceive()</span> reads
  only the header, and you can call <span class="keyword apiname">MsgRead()</span> one or more times to
  read data directly into the required buffer(s).
</li>


<li class="li">A message is received but can't be handled at the present time. At
  some point in the future, an event will occur that will allow the
  message to be processed. Rather than saving the message until it can be
  processed (thus using memory resources), you can use <span class="keyword apiname">MsgRead()</span>
  to reread the message, during which time the sending
  thread is still blocked.
</li>


<li class="li">Messages that are larger than available buffer space are received. Perhaps
  the process is an agent between two processes and simply filters the data and passes it on.
  You can use <span class="keyword apiname">MsgRead()</span> to read the message in small pieces,
  and use <span class="keyword apiname">MsgWrite*()</span> to write the messages in small pieces.
</li>


</ul>


<p class="p">
When you're finished using <span class="keyword apiname">MsgRead()</span>, you must use
<span class="keyword apiname">MsgReply*()</span> to ready the
REPLY-blocked process and complete the message exchange.
</p>


<p class="p"><strong class="ph b">Blocking states</strong></p>




<p class="p">
None for the local case. In the network case:
</p>


<dl class="dl">

<dt class="dt dlterm" id="msgread__state_reply"><span class="keyword const">STATE_REPLY</span></dt>

<dd class="dd">The calling thread is waiting for a network operation to complete.
  The calling thread is marked as REPLY-blocked on itself (the same process ID as the thread making the call).
  
</dd>



</dl>


<p class="p"><strong class="ph b">Native networking</strong></p>


<p class="p">
The <span class="keyword apiname">MsgRead()</span> function has increased latency when 
it's used to communicate across a networkâa message pass is involved from the server
to the network manager (at least). Depending on the size of
the data transfer, the server's <span class="ph filepath">lsm-qnet.so</span> and the
client's <span class="ph filepath">lsm-qnet.so</span> may need to communicate over
the link to read more data bytes from the client.
</p>


</div>



<div class="section" id="msgread__Returns"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">
The only difference between these functions is the way they indicate errors:
</p>

  
<dl class="dl" compact="compact">

<dt class="dt dlterm"><span class="keyword apiname">MsgRead()</span></dt>

<dd class="dd">If successful, this function returns the number of bytes read. If an error occurs, it returns -1 and sets
<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a>.
</dd>


    

<dt class="dt dlterm"><span class="keyword apiname">MsgRead_r()</span></dt>

<dd class="dd">If succesful, this function returns the number of bytes read. If an error occurs,
it may return the negative of any value from the Errors section.
This function does <strong class="ph b">NOT</strong> set <var class="keyword varname">errno</var>, even on success.
</dd>


    
</dl>


<p class="p">
The bytes copied will be the smaller of the data available on the client side (message size -
offset) and the server side (bytes). If the offset is past the end of the client's buffer, this
function will copy 0 bytes and return 0.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl" compact="compact">

<dt class="dt dlterm"><span class="keyword const">EDEADLK</span></dt>

<dd class="dd">A deadlock occurred. You can avoid a deadlock by setting the <span class="keyword const">_NTO_CHF_MSG_PAUSING</span>
flag when you create a channel; for more information, see <a class="xref" href="../c/channelcreate.html" title="Create a communications channel"><span class="keyword apiname">ChannelCreate()</span></a> and <a class="xref" href="msgpause.html" title="Pause the processing of a message"><span class="keyword apiname">MsgPause()</span></a>.</dd>




<dt class="dt dlterm"><span class="keyword const">EFAULT</span></dt>

<dd class="dd">A fault occurred when the kernel tried to access the buffers provided by the client.</dd>




<dt class="dt dlterm"><span class="keyword const">ESRCH</span></dt>

<dd class="dd">The thread indicated by <var class="keyword varname">rcvid</var> doesn't exist, is no longer REPLY-blocked on
the channel, or the connection was detached.</dd>




<dt class="dt dlterm"><span class="keyword const">ESRVRFAULT</span></dt>

<dd class="dd">A fault occurred in a server's address space when the kernel tried to access the server's
message buffers.</dd>




<dt class="dt dlterm"><span class="keyword const">ETIMEDOUT</span></dt>

<dd class="dd">A kernel timeout unblocked the call. See <a class="xref" href="../t/timertimeout.html" title="Set a timeout on a blocking state"><span class="keyword apiname">TimerTimeout()</span></a>.</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">QNX Neutrino</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d2238146e425">Safety:</th>
<th class="entry" valign="top" id="d2238146e427">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d2238146e425 d2238146e427 ">Cancellation point</td>
<td class="entry" valign="top" headers="d2238146e425 d2238146e427 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2238146e425 d2238146e427 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d2238146e425 d2238146e427 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2238146e425 d2238146e427 ">Signal handler</td>
<td class="entry" valign="top" headers="d2238146e425 d2238146e427 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d2238146e425 d2238146e427 ">Thread</td>
<td class="entry" valign="top" headers="d2238146e425 d2238146e427 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>


<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.getting_started/topic/s1_msg.html" title="Message Passing (Getting Started with QNX Neutrino)">Message Passing (Getting Started with <span class="keyword">QNX Neutrino</span>)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreadv.html" title="Read data from a message">MsgReadv(), MsgReadv_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreceive.html" title="Wait for a message or pulse on a channel">MsgReceive(), MsgReceive_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreceivev.html" title="Wait for a message or pulse on a channel">MsgReceivev(), MsgReceivev_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreply.html" title="Reply with a message">MsgReply(), MsgReply_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgreplyv.html" title="Reply with a message">MsgReplyv(), MsgReplyv_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgwrite.html" title="Write a reply">MsgWrite(), MsgWrite_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/msgwritev.html" title="Write a reply">MsgWritev(), MsgWritev_r()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-m.html" title="M"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">M</span></a></span>  </div>
</body>
</html>