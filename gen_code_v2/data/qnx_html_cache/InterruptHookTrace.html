
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="InterruptHookTrace()" /><meta name="abstract" content="Attach the pseudo interrupt handler that the instrumented module uses" /><meta name="description" content="Attach the pseudo interrupt handler that the instrumented module uses" /><meta name="indexterms" content="InterruptHookTrace()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-i.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.prog/topic/inthandler.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.sat/topic/about.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/i/interruptattach.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/i/interruptattacharray.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/i/interruptdetach.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/procmgr_ability.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/t/traceevent.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="interrupthooktrace" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>InterruptHookTrace()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="interrupthooktrace">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-i.html" title="I">I</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-i.html" title="I"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">I</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">InterruptHookTrace()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>




<div class="body refbody"><p class="shortdesc"><em class="ph i">Attach the pseudo interrupt handler that the instrumented module uses</em></p>


<div class="section">

<p class="p">





</p>

</div>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;sys/neutrino.h&gt;

int InterruptHookTrace( 
   const struct sigevent * (* <var class="keyword varname">handler</var>)(int),
   unsigned <var class="keyword varname">flags</var> );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">


<dt class="dt dlterm"><var class="keyword varname">handler</var></dt>


<dd class="dd">A pointer to the handler function.

</dd>




<dt class="dt dlterm"><var class="keyword varname">flags</var></dt>

<dd class="dd">There are currently no flags that apply; specify 0 for this argument.

  

  
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>

<p class="p">Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">



The <span class="keyword apiname">InterruptHookTrace()</span> kernel call
attaches the specified handler to a synthetic interrupt, which is generated when trace data becomes available.
Before calling this function, the thread must have the <span class="keyword const">PROCMGR_AID_INTERRUPT</span> ability enabled.
For more information, see
<a class="xref" href="../p/procmgr_ability.html" title="Control a process's ability to perform certain operations"><span class="keyword apiname">procmgr_ability()</span></a>.
</p>


<p class="p">
You'd use this function if you were writing your own data-capture program and had earlier called
<a class="xref" href="../t/traceevent.html" title="Control the tracing of kernel events"><span class="keyword apiname">TraceEvent()</span></a>
with the <span class="keyword const">_NTO_TRACE_ALLOCBUFFER</span> command to create the kernel's ring of trace buffers.
</p>


<p class="p">
To detach the interrupt handler, call
<a class="xref" href="interruptdetach.html" title="Detach an interrupt handler by ID"><span class="keyword apiname">InterruptDetach()</span></a>;
you can't pass <span class="keyword const">NULL</span> for the <var class="keyword varname">handler</var> argument.
</p>


<p class="p">
The <var class="keyword varname">handler</var> argument specifies the function that you want to be called to receive
trace events from the kernel.
Its prototype is as follows:
</p>


<pre class="pre codeblock">
const struct sigevent* handler( int <var class="keyword varname">info</var> );
</pre>


<p class="p">
You can use some macros that are defined in <span class="ph filepath">&lt;sys/trace.h&gt;</span> to
extract the data that's included in the <var class="keyword varname">info</var> argument:
</p>


<dl class="dl">

<dt class="dt dlterm"><span class="keyword apiname">_TRACE_GET_BUFFNUM(info)</span></dt>

<dd class="dd">Extract the buffer number, which is an index into the kernel's trace buffers.
  For example, if you allocated four trace buffers, the sequence of buffer numbers would be
  0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, and so on.
  
</dd>




<dt class="dt dlterm"><span class="keyword apiname">_TRACE_GET_BUFFSEQ(info)</span></dt>

<dd class="dd">Extract the buffer sequence number, which
  indicates where the data in the buffer fits into the progression of data since you started tracing.
  The buffer sequence numbers start at 1 and increase monotonically.
  You can use this number to determine whether or not you're keeping up with the trace data.
  
</dd>



</dl>


<p class="p">
The handler function runs in the environment of your process.
For guidelines on writing this handler, see
<span class="q">&#147;<a class="xref" href="interruptattach.html#interruptattach__HandlerFunction">Interrupt handler function</a>&#148;</span>
in the entry for <span class="keyword apiname">InterruptAttach()</span>.
</p>


<p class="p"><strong class="ph b">Blocking states</strong></p>




<p class="p">
This call doesn't block.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">
An interrupt function ID, or -1 if an error occurs 
(<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a> is set).
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl" compact="compact">


<dt class="dt dlterm"><span class="keyword const">EAGAIN</span></dt>

<dd class="dd">All kernel interrupt entries are in use.</dd>




<dt class="dt dlterm"><span class="keyword const">EFAULT</span></dt>

<dd class="dd">A fault occurred when the kernel tried to access the buffers provided.</dd>




<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">The <var class="keyword varname">handler</var> argument is <span class="keyword const">NULL</span>.</dd>




<dt class="dt dlterm"><span class="keyword const">EPERM</span></dt>

<dd class="dd">The process doesn't have the required permission; see
  <a class="xref" href="../p/procmgr_ability.html" title="Control a process's ability to perform certain operations"><span class="keyword apiname">procmgr_ability()</span></a>.
</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">QNX Neutrino</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d1993864e352">Safety:</th>
<th class="entry" valign="top" id="d1993864e354">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d1993864e352 d1993864e354 ">Cancellation point</td>
<td class="entry" valign="top" headers="d1993864e352 d1993864e354 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1993864e352 d1993864e354 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d1993864e352 d1993864e354 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1993864e352 d1993864e354 ">Signal handler</td>
<td class="entry" valign="top" headers="d1993864e352 d1993864e354 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d1993864e352 d1993864e354 ">Thread</td>
<td class="entry" valign="top" headers="d1993864e352 d1993864e354 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>


<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.prog/topic/inthandler.html" title="Writing an Interrupt Handler (QNX Neutrino Programmer's Guide)">Writing an Interrupt Handler (<span class="keyword">QNX Neutrino</span> Programmer's Guide)</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.sat/topic/about.html" title="System Analysis Toolkit (SAT) User's Guide">System Analysis Toolkit (SAT) User's Guide</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/i/interruptattach.html" title="Attach an Interrupt Service Routine (ISR) to an interrupt source">InterruptAttach(), InterruptAttach_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/i/interruptattacharray.html" title="Attach an Interrupt Service Routine (ISR) that returns an array of sigevents to an interrupt source">InterruptAttachArray(), InterruptAttachArray_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/i/interruptdetach.html" title="Detach an interrupt handler by ID">InterruptDetach(), InterruptDetach_r()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/procmgr_ability.html" title="Control a process's ability to perform certain operations">procmgr_ability()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/t/traceevent.html" title="Control the tracing of kernel events">TraceEvent()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-i.html" title="I"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">I</span></a></span>  </div>
</body>
</html>