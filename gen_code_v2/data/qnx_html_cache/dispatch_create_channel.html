
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="dispatch_create_channel()" /><meta name="abstract" content="Allocate a dispatch structure, specifying a channel ID" /><meta name="description" content="Allocate a dispatch structure, specifying a channel ID" /><meta name="indexterms" content="dispatch_create_channel()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-d.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_block.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_context_alloc.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_context_free.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_create.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_destroy.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_handler.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_timeout.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_unblock.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.resmgr/topic/skeleton_RESMGR_layers.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.getting_started/topic/s1_resmgr.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/c/channelcreate.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/m/message_attach.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/n/name_attach.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/p/pulse_attach.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/r/resmgr_attach.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/select_attach.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/t/timespec.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="dispatch_create_channel" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>dispatch_create_channel()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="dispatch_create_channel">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-d.html" title="D">D</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-d.html" title="D"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">D</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">dispatch_create_channel()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>


<div class="body refbody"><p class="shortdesc"><em class="ph i">Allocate a dispatch structure, specifying a channel ID</em></p>


<div class="section">

<p class="p">


</p>

</div>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;sys/iofunc.h&gt;
#include &lt;sys/dispatch.h&gt;

dispatch_t *dispatch_create_channel( int <var class="keyword varname">chid</var>,
                                     unsigned <var class="keyword varname">flags</var> );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">chid</var></dt>

<dd class="dd">The ID of the channel to use for the dispatch layer, or -1 to create the channel.</dd>




<dt class="dt dlterm"><var class="keyword varname">flags</var></dt>

<dd class="dd">Zero or more of the following bits:

  <ul class="ul">
  <li class="li"><span class="keyword const">DISPATCH_FLAG_NOLOCK</span> â (QNX Neutrino 7.1 or later) enable the lockless handling of
    messages (see below). 
    
  </li>


  </ul>

</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>

<p class="p">Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">
The <span class="keyword apiname">dispatch_create_channel()</span> function allocates and
initializes a dispatch structure, and returns a handle to this structure.
This function is similar to
<a class="xref" href="dispatch_create.html" title="Allocate a dispatch structure and create the channel associated with it"><span class="keyword apiname">dispatch_create()</span></a>
but lets you specify a channel and flags.
This is useful if you want to control the channel for 
<a class="xref" href="../n/name_attach.html" title="Register a name in the pathname space and create a channel"><span class="keyword apiname">name_attach()</span></a> or 
<a class="xref" href="../r/resmgr_attach.html" title="Attach a path to the pathname space"><span class="keyword apiname">resmgr_attach()</span></a>.
For example, if you wanted two or more names to the same channel, or if you wanted non-default channel flags.
</p>


<p class="p">
After you've called this function, you need to call one or more of the following functions to
attach handlers for the things you want the dispatch layer to deal with:
</p>


<ul class="ul">
<li class="li"><a class="xref" href="../m/message_attach.html" title="Attach a message range"><span class="keyword apiname">message_attach()</span></a></li>

<li class="li"><a class="xref" href="../p/pulse_attach.html" title="Attach a handler function to a pulse code"><span class="keyword apiname">pulse_attach()</span></a></li>

<li class="li"><a class="xref" href="../r/resmgr_attach.html" title="Attach a path to the pathname space"><span class="keyword apiname">resmgr_attach()</span></a></li>

<li class="li"><a class="xref" href="../s/select_attach.html" title="Attach a file descriptor to a dispatch handle"><span class="keyword apiname">select_attach()</span></a></li>

</ul>


<p class="p">
Then you call
<a class="xref" href="dispatch_context_alloc.html" title="Return a dispatch context"><span class="keyword apiname">dispatch_context_alloc()</span></a>
to allocate the context for
<a class="xref" href="dispatch_block.html" title="Block while waiting for an event"><span class="keyword apiname">dispatch_block()</span></a>
and
<a class="xref" href="dispatch_handler.html" title="Handle events received by dispatch_block()"><span class="keyword apiname">dispatch_handler()</span></a>.
</p>


<div class="note note"><span class="notetitle">Note:</span> 
Once you've called <span class="keyword apiname">dispatch_context_alloc()</span>, don't call
<span class="keyword apiname">message_attach()</span> or <span class="keyword apiname">resmgr_attach()</span>
specifying a larger maximum message size or a larger number of message parts for the same dispatch structure.
In QNX Neutrino 7.0 or later, these functions indicate an error of <span class="keyword const">EINVAL</span> if this happens.
</div>


<p class="p">
If the dispatch structure is for use in a resource manager, meaning you will later call <span class="keyword apiname">resmgr_attach()</span>
with the associated dispatch handle, then at least the flags <span class="keyword const">_NTO_CHF_UNBLOCK</span> and <span class="keyword const">_NTO_CHF_DISCONNECT</span>
should be set for the supplied channel to ensure proper resource manager behavior.
If using <span class="keyword apiname">select_attach()</span> with the <span class="keyword const">SELECT_FLAG_SRVEXCEPT</span>,
then <span class="keyword const">_NTO_CHF_COID_DISCONNECT</span> is also required.
</p>


<p class="p">
If you wish, you can do a <span class="keyword apiname">resmgr_attach()</span>
with a <span class="keyword const">NULL</span> path.  This has the effect of initializing
the dispatch structure to receive messages, among other things.
</p>


<div class="note note"><span class="notetitle">Note:</span> 

In order to create a public channel (i.e., <em class="ph i">without</em> <span class="keyword const">_NTO_CHF_PRIVATE</span> set),
your process must have the <span class="keyword const">PROCMGR_AID_PUBLIC_CHANNEL</span> ability enabled.
For more information, see
<a class="xref" href="../p/procmgr_ability.html" title="Control a process's ability to perform certain operations"><span class="keyword apiname">procmgr_ability()</span></a>.
</div>


<p class="p">
In most resource managers, the mapping from message types to message handlers is static for the life of the
resource manager, but the lookup must be done on every message.
The framework locks and unlocks the mapping data on every message, but if a resource manager is going to have
a static mapping, this overhead can be eliminated.
Setting the <span class="keyword const">DISPATCH_FLAG_NOLOCK</span> flag tells the dispatch framework that it can safely eliminate
those protections.
This means that once the dispatch framework becomes active (that is, once at least one call to
<span class="keyword apiname">dispatch_context_alloc()</span> has been made with the dispatch framework), the mapping can't be changed.
This has the restrictions that for an active dispatch framework (dpp) you may not call:
</p>


<ul class="ul">
<li class="li"><span class="keyword apiname">message_attach()</span></li>

<li class="li"><span class="keyword apiname">message_detach()</span></li>

<li class="li"><span class="keyword apiname">pulse_attach()</span></li>

<li class="li"><span class="keyword apiname">pulse_detach()</span></li>


<li class="li"><span class="keyword apiname">resmgr_attach()</span> unless at least one <span class="keyword apiname">resmgr_attach()</span> has been done
  before the <span class="keyword apiname">dispatch_context_alloc()</span>
</li>


<li class="li"><span class="keyword apiname">select_attach()</span> unless at least one <span class="keyword apiname">select_attach()</span> has been done
   before the <span class="keyword apiname">dispatch_context_alloc()</span>
</li>


<li class="li"><span class="keyword apiname">select_attach()</span> with the <span class="keyword const">SELECT_FLAG_SRVEXCEPT</span> flag unless at least one
  <span class="keyword apiname">select_attach()</span> with the <span class="keyword const">SELECT_FLAG_SRVEXCEPT</span> flag has been done before the
  <span class="keyword apiname">dispatch_context_alloc()</span></li>

</ul>


<p class="p">
The <span class="keyword apiname">dispatch_create_channel()</span> function is part of the dispatch layer of a resource manager.
For more information, see
<span class="q">&#147;<a class="xref" href="../../../com.qnx.doc.neutrino.resmgr/topic/skeleton_RESMGR_layers.html">Layers in a resource manager</a>&#148;</span>
in the <span class="q">&#147;The Bones of a Resource Manager&#148;</span> chapter of <cite class="cite">Writing a Resource Manager</cite>.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<p class="p">

A handle to a dispatch structure, or <span class="keyword const">NULL</span> if an error occurred
(<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a>
is set).
The <span class="keyword dtype">dispatch_t</span> structure
is an opaque data type; you can't access its contents directly.
</p>


</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl">

<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">(QNX Neutrino 7.0 or later) The <var class="keyword varname">flags</var> argument is invalid.</dd>




<dt class="dt dlterm"><span class="keyword const">ENOMEM</span></dt>

<dd class="dd">Insufficient memory to allocate context.</dd>



</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">QNX Neutrino</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d1347161e459">Safety:</th>
<th class="entry" valign="top" id="d1347161e461">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d1347161e459 d1347161e461 ">Cancellation point</td>
<td class="entry" valign="top" headers="d1347161e459 d1347161e461 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1347161e459 d1347161e461 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d1347161e459 d1347161e461 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1347161e459 d1347161e461 ">Signal handler</td>
<td class="entry" valign="top" headers="d1347161e459 d1347161e461 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1347161e459 d1347161e461 ">Thread</td>
<td class="entry" valign="top" headers="d1347161e459 d1347161e461 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>


<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.resmgr/topic/skeleton_RESMGR_layers.html" title="Layers in a resource manager (Writing a Resource Manager)">Layers in a resource manager (Writing a Resource Manager)</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.getting_started/topic/s1_resmgr.html" title="Resource Managers (Getting Started with QNX Neutrino)">Resource Managers (Getting Started with <span class="keyword">QNX Neutrino</span>)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_block.html" title="Block while waiting for an event">dispatch_block()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_context_alloc.html" title="Return a dispatch context">dispatch_context_alloc()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_context_free.html" title="Free a dispatch context">dispatch_context_free()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_create.html" title="Allocate a dispatch structure and create the channel associated with it">dispatch_create()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_destroy.html" title="Destroy a dispatch handle, without cleaning up the dispatch framework">dispatch_destroy()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_handler.html" title="Handle events received by dispatch_block()">dispatch_handler()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_timeout.html" title="Set a timeout">dispatch_timeout()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/d/dispatch_unblock.html" title="Unblock a thread that is blocked on a dispatch handle">dispatch_unblock()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/c/channelcreate.html" title="Create a communications channel">ChannelCreate(), ChannelCreate_r(), ChannelCreatePulsePool()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/m/message_attach.html" title="Attach a message range">message_attach()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/n/name_attach.html" title="Register a name in the pathname space and create a channel">name_attach()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/p/pulse_attach.html" title="Attach a handler function to a pulse code">pulse_attach()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/r/resmgr_attach.html" title="Attach a path to the pathname space">resmgr_attach()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/select_attach.html" title="Attach a file descriptor to a dispatch handle">select_attach()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/t/timespec.html" title="Time-specification structure">timespec</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-d.html" title="D"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">D</span></a></span>  </div>
</body>
</html>