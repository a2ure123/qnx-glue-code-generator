
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="linkat()" /><meta name="abstract" content="Create a link to an existing file located at a given path" /><meta name="description" content="Create a link to an existing file located at a given path" /><meta name="indexterms" content="linkat(), files, linking to, I/O, files, linking to" /><meta name="DC.subject" content=", linkat(), files, linking to, I/O" /><meta name="keywords" content=", linkat(), files, linking to, I/O" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-l.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/e/errno.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/l/link.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/symlinkat.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/u/unlinkat.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="linkat" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>linkat()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="linkat">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-l.html" title="L">L</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-l.html" title="L"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">L</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">linkat()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>





<div class="body refbody"><p class="shortdesc"><em class="ph i">Create a link to an existing file located at a given path</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;fcntl.h&gt;

int linkat( int <var class="keyword varname">olddirfd</var>, 
            const char *const <var class="keyword varname">oldpath</var>,
            int <var class="keyword varname">newdirfd</var>, 
            const char *const <var class="keyword varname">newpath</var>,
            int <var class="keyword varname">flags</var> );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Arguments:</h2>


<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">olddirfd</var></dt>

<dd class="dd">A file descriptor that indicates the base directory for relative file paths.
    The pathname given in <var class="keyword varname">oldpath</var> is resolved by appending it to the directory associated with <var class="keyword varname">olddirfd</var>.
    You can set this argument to <span class="keyword const">AT_FDCWD</span> to use the current working directory as the base directory.
    <div class="note note"><span class="notetitle">Note:</span> The QNX Neutrino implementation of the <span class="keyword apiname">*at()</span> functions differ from the POSIX standards.
        You must use a file descriptor obtained from an <span class="keyword apiname">open()</span> or <span class="keyword apiname">openat()</span> call with the
        <a class="xref" href="../o/open.html#open__O_DIRECTORY"><span class="keyword const">O_DIRECTORY</span></a> flag set, rather than the <span class="keyword const">O_SEARCH</span>
        flag on POSIX. Otherwise, the function fails and sets <var class="keyword varname">errno</var> to <span class="keyword const">ENOTDIR</span>.</div>

    <p class="p">If <var class="keyword varname">oldpath</var> specifies an absolute path, <var class="keyword varname">olddirfd</var> has no effect.</p>
</dd>




<dt class="dt dlterm"><var class="keyword varname">oldpath</var></dt>

<dd class="dd">The path of an existing file that you're creating a hard link to.
    This can be absolute or relative; for details of how relative pathname resolution is done, see above.</dd>




<dt class="dt dlterm"><var class="keyword varname">newdirfd</var></dt>

<dd class="dd">A file descriptor that indicates the base directory for relative file paths.
    The pathname given in <var class="keyword varname">newpath</var> is resolved by appending it to the directory associated with <var class="keyword varname">newdirfd</var>.
    You can set this argument to <span class="keyword const">AT_FDCWD</span> to use the current working directory as the base directory.
    <div class="note note"><span class="notetitle">Note:</span> The QNX Neutrino implementation of the <span class="keyword apiname">*at()</span> functions differ from the POSIX standards.
        You must use a file descriptor obtained from an <span class="keyword apiname">open()</span> or <span class="keyword apiname">openat()</span>call with the
        <a class="xref" href="../o/open.html#open__O_DIRECTORY"><span class="keyword const">O_DIRECTORY</span></a> flag set, rather than the <span class="keyword const">O_SEARCH</span>
        flag on POSIX. Otherwise, the function fails and sets <var class="keyword varname">errno</var> to <span class="keyword const">ENOTDIR</span>.</div>

    <p class="p">If <var class="keyword varname">newpath</var> specifies an absolute path, <var class="keyword varname">newdirfd</var> has no effect.</p>
</dd>




<dt class="dt dlterm"><var class="keyword varname">newpath</var></dt>

<dd class="dd">The path of the new link.
    This can be absolute or relative; for details of how relative pathname resolution is done, see above.</dd>




<dt class="dt dlterm"><var class="keyword varname">flags</var></dt>

<dd class="dd">A bitfield of the following flags:
    <ul class="ul">
        <li class="li"><span class="keyword const">AT_SYMLINK_FOLLOW</span> â 
            if <var class="keyword varname">oldpath</var> names a symbolic link, create a new link for the target of the symbolic link.</li>

    </ul>

</dd>


</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>


<p class="p">
Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">
The <span class="keyword apiname">linkat()</span> function creates a new directory entry named by <var class="keyword varname">newpath</var> to refer to
(that is, to be a hard link to) an existing file named by <var class="keyword varname">oldpath</var>.
Each of the <var class="keyword varname">oldpath</var> and <var class="keyword varname">newpath</var> arguments can contain an absolute or a relative path.
In the latter case, the corresponding file descriptor argument (<var class="keyword varname">olddirfd</var> for <var class="keyword varname">oldpath</var> and
<var class="keyword varname">newdirfd</var> for <var class="keyword varname">newpath</var>) is used to resolve the pathname, as explained in the descriptions
of these arguments (above).
</p>


<p class="p">
For <var class="keyword varname">olddirfd</var> and <var class="keyword varname">newdirfd</var>,
the function checks if directory searches are permitted using the current permissions of the directory underlying the file descriptor.
</p>


<p class="p">
When the <var class="keyword varname">flags</var> field is 0, this function is equivalent to <span class="keyword apiname">link()</span> when both
<var class="keyword varname">oldpath</var> and <var class="keyword varname">newpath</var> are absolute and not relative paths.
For details about other possible <var class="keyword varname">flags</var> settings, see this argument's description (above).
</p>


<p class="p">
<span class="keyword">QNX Neutrino</span> has no concept of a path operation (<span class="keyword apiname">open()</span>, <span class="keyword apiname">readlink()</span>, etc.)
that references a path relative to an already open file descriptor (for a directory), as far as the filesystem resource manager is
concerned. Therefore, it's not possible to eliminate the race inherent in looking up a pathname with multiple intervening directories
or symbolic links. However, <span class="keyword apiname">linkat()</span> can still be used for maintaining a per-thread current working directory,
using file descriptors maintained by the application.
</p>


<div class="note note"><span class="notetitle">Note:</span> 
This implementation doesn't support using <span class="keyword apiname">linkat()</span> on directories or
the linking of files across filesystems (different logical disks).
</div>


<p class="p">


If it succeeds, the <span class="keyword apiname">linkat()</span> function atomically creates a new link for the existing file and increments
the link count of the file by one. For information about which fields of the file and the directory are updated,
see the <a class="xref" href="link.html" title="Create a link to an existing file"><span class="keyword apiname">link()</span></a> reference.
If the function fails, no link is created, and the link count of the file remains unchanged.
</p>


</div>



<div class="section"><h2 class="title sectiontitle">Returns:</h2>


<dl class="dl" compact="compact">

<dt class="dt dlterm">0</dt>

<dd class="dd">Success.</dd>




<dt class="dt dlterm">-1</dt>

<dd class="dd">An error occurred (<a class="xref" href="../e/errno.html" title="Thread-local error variable"><var class="keyword varname">errno</var></a> is set).</dd>


</dl>


</div>



<div class="section"><h2 class="title sectiontitle">Errors:</h2>


<dl class="dl" compact="compact">


<dt class="dt dlterm"><span class="keyword const">EACCES</span></dt>

<dd class="dd">One of the following is true:
  <ul class="ul">
    <li class="li">A component of the path prefix in <var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var> denies search permission.</li>

    <li class="li">You don't have permission to search the directory underlying <var class="keyword varname">olddirfd</var> or <var class="keyword varname">newdirfd</var>.</li>

    <li class="li">The link named by <var class="keyword varname">newpath</var> is in a directory with a mode that denies write permission.</li>

    <li class="li">The calling process does not have permission to access the existing file and this is required by the implementation.</li>

  </ul>

</dd>




<dt class="dt dlterm"><span class="keyword const">EBADF</span></dt>

<dd class="dd">One of the paths (<var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var>) does not specify an absolute path and the
  corresponding file descriptor (<var class="keyword varname">olddirfd</var> or <var class="keyword varname">newdirfd</var>) is neither <span class="keyword const">AT_FDCWD</span>
  nor a valid file descriptor open for reading.</dd>




<dt class="dt dlterm"><span class="keyword const">EEXIST</span></dt>

<dd class="dd">The link named by <var class="keyword varname">newpath</var> already exists.</dd>




<dt class="dt dlterm"><span class="keyword const">EINVAL</span></dt>

<dd class="dd">An invalid value was specified for <var class="keyword varname">flags</var>.</dd>




<dt class="dt dlterm"><span class="keyword const">ELOOP</span></dt>

<dd class="dd">During resolution of the <var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var> argument,
  too many levels of symbolic links were encountered.</dd>




<dt class="dt dlterm"><span class="keyword const">EMLINK</span></dt>

<dd class="dd">The number of links to the file named by <var class="keyword varname">oldpath</var> would exceed <span class="keyword const">LINK_MAX</span>.
  </dd>




<dt class="dt dlterm"><span class="keyword const">ENAMETOOLONG</span></dt>

<dd class="dd">The length of the <var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var> string exceeds <span class="keyword const">PATH_MAX</span>,
  or the resolution of a symbolic link within one of these strings produced a result longer than <span class="keyword const">PATH_MAX</span>.</dd>




<dt class="dt dlterm"><span class="keyword const">ENOENT</span></dt>

<dd class="dd">One of the following conditions is true:
  <ul class="ul">
    <li class="li">A component of the path prefix in <var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var> doesn't exist.</li>

    <li class="li">The file named by <var class="keyword varname">oldpath</var> doesn't exist.</li>

    <li class="li">Either <var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var> points to an empty string.</li>

  </ul>

</dd>




<dt class="dt dlterm"><span class="keyword const">ENOSPC</span></dt>

<dd class="dd">The directory that would contain the link can't be extended.</dd>




<dt class="dt dlterm"><span class="keyword const">ENOSYS</span></dt>

<dd class="dd">The <span class="keyword apiname">linkat()</span> function isn't implemented for the filesystem underlying the
  path specified in <var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var>.</dd>




<dt class="dt dlterm"><span class="keyword const">ENOTDIR</span></dt>

<dd class="dd">One of the following is true:
  <ul class="ul">
    <li class="li">A component of the path prefix in <var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var> names an existing file
        that is neither a directory nor a symbolic link to one.</li>

    <li class="li">The pathname in <var class="keyword varname">oldpath</var> contains at least one non-slash character, ends with at least one slash character
        (<tt class="ph tt">/</tt>), and the last component names an existing file that is neither a directory nor a symbolic link to one.</li>

    <li class="li">The path in <var class="keyword varname">oldpath</var> names an existing non-directory and the path in <var class="keyword varname">newpath</var>
        names a non-existent file, contains at least one non-slash character, and ends with at least one slash character (<tt class="ph tt">/</tt>).</li>

    <li class="li">The <var class="keyword varname">oldpath</var> or <var class="keyword varname">newpath</var> argument isn't an absolute path and the associated
        <var class="keyword varname">olddirfd</var> or <var class="keyword varname">newdirfd</var> file descriptor is associated with a non-directory file.</li>

    <li class="li">One of the file descriptors (<var class="keyword varname">olddirfd</var> or <var class="keyword varname">newdirfd</var>) was created without
        <span class="keyword const">O_DIRECTORY</span> set.</li>

  </ul>

</dd>




<dt class="dt dlterm"><span class="keyword const">EPERM</span></dt>

<dd class="dd">The file named by <var class="keyword varname">oldpath</var> is a directory and the calling process doesn't have the appropriate permissions.</dd>




<dt class="dt dlterm"><span class="keyword const">EROFS</span></dt>

<dd class="dd">The requested link requires writing in a directory on a read-only filesystem.</dd>




<dt class="dt dlterm"><span class="keyword const">EXDEV</span></dt>

<dd class="dd">The link named by <var class="keyword varname">newpath</var> and the file named by <var class="keyword varname">oldpath</var> are on different filesystems and
  the implementation doesn't support links between filesystems. Or, <var class="keyword varname">oldpath</var> refers to a named stream.</dd>



</dl>


</div>






<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">POSIX 2008</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d2110805e737">Safety:</th>
<th class="entry" valign="top" id="d2110805e739">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d2110805e737 d2110805e739 ">Cancellation point</td>
<td class="entry" valign="top" headers="d2110805e737 d2110805e739 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d2110805e737 d2110805e739 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d2110805e737 d2110805e739 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d2110805e737 d2110805e739 ">Signal handler</td>
<td class="entry" valign="top" headers="d2110805e737 d2110805e739 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d2110805e737 d2110805e739 ">Thread</td>
<td class="entry" valign="top" headers="d2110805e737 d2110805e739 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>





<div class="related-links"><div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/e/errno.html" title="Thread-local error variable">errno</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/l/link.html" title="Create a link to an existing file">link()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/symlinkat.html" title="Create a symbolic link to a path, at a given location">symlinkat()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/u/unlinkat.html" title="Remove a link to a file at a given location">unlinkat()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-l.html" title="L"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">L</span></a></span>  </div>
</body>
</html>