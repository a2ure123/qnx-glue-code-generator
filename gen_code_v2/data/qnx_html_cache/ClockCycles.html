
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="reference" /><meta name="DC.Title" content="ClockCycles()" /><meta name="abstract" content="Get the number of clock cycles" /><meta name="description" content="Get the number of clock cycles" /><meta name="indexterms" content="ClockCycles()" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.getting_started/topic/s1_timer.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/s/syspage_entry.html" /><meta name="DC.Relation" scheme="URI" content="../../../com.qnx.doc.neutrino.lib_ref/topic/t/threadctl.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="clockcycles" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>ClockCycles()</title><link rel="canonical" type="html" href="https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/" /><!--  Generated with Oxygen version 18.1, build number 2017020917.  --><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/resources/skins/skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../../../index.html";
            
            --></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><script type="text/javascript"> var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-27400275-1']); _gaq.push(['_setDomainName', 'www.qnx.com']);_gaq.push(['_setAllowLinker', true]);_gaq.push(['_trackPageview']);(function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="clockcycles">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C">C</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">C</span></a></span>  </span></td></tr></tbody></table>


<h1 class="title topictitle1"><span class="keyword apiname">ClockCycles()</span></h1>
<table width="100%"><tbody><tr><td align="left"><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">QNX SDP</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">7.1</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">C Library Reference</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">API</button><button style="margin:3px 5px; background-color:default; border:default; pointer-events: none; font-size:0.9em;">Developer</button></td><td align="right"><span style="margin:0px 5px; font-size:0.9em;">Updated: October 28, 2024</span></td></tr></tbody></table>



<div class="body refbody"><p class="shortdesc"><em class="ph i">Get the number of clock cycles</em></p>


<div class="section refsyn"><h2 class="title sectiontitle">Synopsis:</h2>

<pre class="pre codeblock">
#include &lt;sys/neutrino.h&gt;
#include &lt;inttypes.h&gt;

uint64_t ClockCycles( void );
</pre>

</div>



<div class="section"><h2 class="title sectiontitle">Library:</h2>


<p class="p"><span class="ph filepath">libc</span></p>


<p class="p">
Use the <span class="keyword option">-l c</span> option to
<a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/q/qcc.html"><span class="keyword cmdname">qcc</span></a>
to link against this library.
This library is usually included automatically.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Description:</h2>


<p class="p">



The <span class="keyword apiname">ClockCycles()</span> function returns the current value of a
free-running 64-bit cycle counter. 
This is implemented on each processor as a high-performance mechanism for timing short intervals.
On Intel, <span class="keyword apiname">ClockCycles()</span> reads the Time Stamp Counter (RDTSC) and on an ARM 64-bit
system, it reads the Generic Timer.




</p>

<p class="p">
You can use the 
<a class="xref" href="../s/syspage_entry.html" title="Return an entry from the system page"><samp class="ph codeph">SYSPAGE_ENTRY(qtime)-&gt;cycles_per_sec</samp></a>
field to get the number of <span class="keyword apiname">ClockCycles()</span> increments in one second.
</p>




<div class="cautiontitle">CAUTION:</div><div class="note caution">
While running your system, you need to ensure that <span class="keyword apiname">ClockCycles()</span> does not roll over.
Although it's uncommon, it's a good idea to check. Knowing that the cycles counter is an unsigned 64-bit integer,
use the following to calculate the duration in seconds to roll over:
<pre class="pre codeblock">
(~(uint64_t)0) / SYSPAGE_ENTRY(qtime)-&gt;cycles_per_sec
</pre>

<p class="p">
For example, a 6 GHz system will take 97 years for <span class="keyword apiname">ClockCycles()</span> to roll over.
</p>

</div>


<div class="note note"><span class="notetitle">Note:</span> 
<span class="keyword">QNX Neutrino</span> requires that the hardware underlying <span class="keyword apiname">ClockCycles()</span>
be synchronized across all processors on an SMP system.
Here, <span class="q">&#147;synchronized&#148;</span> means the difference in time values (i.e., deltas) measured by different processors
must be small enough to be not software observable.
This design means that you don't have to call <samp class="ph codeph">ThreadCtl( _NTO_TCTL_RUNMASK, ...)</samp> to prevent
threads from migrating to another processor between calls to <span class="keyword apiname">ClockCycles()</span>.
</div>

<div class="p">
In some cases, if you don't specify the frequency for <span class="keyword apiname">ClockCycles()</span> via the <span class="keyword option">-f</span> option in <span class="keyword apiname">startup</span>,
<span class="keyword apiname">startup</span> will try to determine the frequency at each target boot. This frequency is not exact and varies from one boot to
another. To ensure consistent results, we recommend that you query your hardware for the frequency, or consult your target's documentation. Once the frequency is determined,
you can either have your target configuration specify the frequency using the <span class="keyword option">-f</span> in <span class="keyword apiname">startup</span>, or modify
<span class="keyword apiname">startup</span> to have the frequency hard-coded. It's important to do this for systems that:
<ul class="ul">
<li class="li">Use high resolution timers</li>

<li class="li">Have tickless operation enabled</li>

<li class="li">Run for a long period of time</li>

</ul>

For more information, see <a class="xref" href="../../../com.qnx.doc.neutrino.utilities/topic/s/startup_options.html" title="Generic options for startup programs (QNX Neutrino)"><span class="keyword apiname">startup</span></a>
in the Utilities Reference guide.
</div>


<h2 class="sectiontitle">Blocking states:</h2>

<p class="p">
This call doesn't block.
</p>


</div>


<div class="section"><h2 class="title sectiontitle">Examples:</h2>


<p class="p">
See <a class="xref" href="../s/syspage_entry.html" title="Return an entry from the system page"><span class="keyword apiname">SYSPAGE_ENTRY()</span></a>.
</p>

</div>



<div class="section"><h2 class="title sectiontitle">Classification:</h2>

<p class="p"><a class="xref" href="../summary.html#summary__CLASSIFICATION">QNX Neutrino</a></p>



<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
<thead class="thead" align="left">
<tr><th class="entry" valign="top" id="d1299716e233">Safety:</th>
<th class="entry" valign="top" id="d1299716e235">Â </th>
</tr>

</thead>

<tbody class="tbody">
<tr><td class="entry" valign="top" headers="d1299716e233 d1299716e235 ">Cancellation point</td>
<td class="entry" valign="top" headers="d1299716e233 d1299716e235 ">No</td>
</tr>

<tr><td class="entry" valign="top" headers="d1299716e233 d1299716e235 ">Interrupt handler</td>
<td class="entry" valign="top" headers="d1299716e233 d1299716e235 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d1299716e233 d1299716e235 ">Signal handler</td>
<td class="entry" valign="top" headers="d1299716e233 d1299716e235 ">Yes</td>
</tr>

<tr><td class="entry" valign="top" headers="d1299716e233 d1299716e235 ">Thread</td>
<td class="entry" valign="top" headers="d1299716e233 d1299716e235 ">Yes</td>
</tr>

</tbody>

</table>
</div>

</div>


</div>





<div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.getting_started/topic/s1_timer.html" title="Clocks, Timers, and Getting a Kick Every So Often (Getting Started with QNX Neutrino)">Clocks, Timers, and Getting a Kick Every So Often (Getting Started with <span class="keyword">QNX Neutrino</span>)</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/s/syspage_entry.html" title="Return an entry from the system page">SYSPAGE_ENTRY()</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../../../com.qnx.doc.neutrino.lib_ref/topic/t/threadctl.html" title="Control a thread">ThreadCtl(), ThreadCtl_r(), ThreadCtlExt(), ThreadCtlExt_r()</a></div>
</div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../../../com.qnx.doc.neutrino.lib_ref/topic/lib-c.html" title="C"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">C</span></a></span>  </div>
</body>
</html>